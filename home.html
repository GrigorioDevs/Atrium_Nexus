<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8"/>

  <!-- Icon title -->
  <link rel="icon" href="assets/img/logo_atrium.png" type="image/x-icon">

  <!-- Viewport corrigido: reduz leve zoom inicial e corrige atributo maximum-scale -->
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>Atrium Nexus</title>

  <!-- √çcones -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

  <!-- Leaflet (mapa) -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <!-- jsPDF (PDF) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <!-- PDF.js (leitura de PDFs para texto) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.10.111/pdf.min.js"></script>
  <script>
    if (window.pdfjsLib) {
      pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.10.111/pdf.worker.min.js';
    }
  </script>

  <!-- Libs front-only -->
  <script src="https://unpkg.com/mammoth@1.6.0/mammoth.browser.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

  <!-- Signature Pad -->
  <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.1.7/dist/signature_pad.umd.min.js"></script>

  <!-- CSS base -->
  <link rel="stylesheet" href="assets/css/00-reset.css">
  <link rel="stylesheet" href="assets/css/01-tokens.css">
  <link rel="stylesheet" href="assets/css/02-base.css">
  <link rel="stylesheet" href="assets/css/10-layout.css">


  <!-- Componentes -->
  <link rel="stylesheet" href="assets/css/20-components/button.css">
  <link rel="stylesheet" href="assets/css/20-components/card.css">
  <link rel="stylesheet" href="assets/css/20-components/table.css">
  <link rel="stylesheet" href="assets/css/20-components/form.css">
  <link rel="stylesheet" href="assets/css/20-components/modal.css">
  <link rel="stylesheet" href="assets/css/20-components/tabs.css">
  <link rel="stylesheet" href="assets/css/20-components/toast.css">
  <link rel="stylesheet" href="assets/css/20-components/splash.css">

  <!-- M√≥dulos -->
  <link rel="stylesheet" href="assets/css/30-modulos/ponto.css">
  <link rel="stylesheet" href="assets/css/30-modulos/incluir-ponto.css">
  <link rel="stylesheet" href="assets/css/30-modulos/documentos.css">
  <link rel="stylesheet" href="assets/css/30-modulos/funcionarios.css">
  <link rel="stylesheet" href="assets/css/30-modulos/beneficios.css">
  <link rel="stylesheet" href="assets/css/30-modulos/assinatura-publica.css">
  <link rel="stylesheet" href="assets/css/30-modulos/ponto-justificativa.css">
  <link rel="stylesheet" href="assets/css/30-modulos/assinatura-clicksign.css">
  <link rel="stylesheet" href="assets/css/30-modulos/alerts.css">
  <link rel="stylesheet" href="assets/css/30-modulos/usuarios.css">
  <link rel="stylesheet" href="assets/css/30-modulos/cracha.css">

  <!-- Outros -->
  <link rel="stylesheet" href="assets/css/40-integracoes.css">
  <link rel="stylesheet" href="assets/css/90-utilities.css">
  <link rel="stylesheet" href="assets/css/95-print.css">
  <link rel="stylesheet" href="assets/css/99-overrides.css">
</head>
<body>

  <!-- Splash -->
  <div id="splash">
    <div class="splash-card">
      <img class="splash-logo" src="assets/img/logo_rcr_transparente.png" alt="RCR" onerror="this.style.display='none'">
      <div class="splash-title">RCR Engenharia</div>
    </div>
  </div>

  <!-- Toasts -->
  <div class="toast-container" id="toastContainer"></div>

  <button class="menu-toggle" id="btnHamb" aria-label="Abrir menu">
    <i class="fa fa-bars" aria-hidden="true"></i>
  </button>

  <div class="container">
    <!-- Sidebar -->
    <aside id="sidebar" aria-label="Menu lateral">
      <div class="brand">
        <img class="brand-logo" src="assets/img/icone_rcr.png" alt="RCR" onerror="this.remove()">
        <strong class="spand">RCR Engenharia</strong>
      </div>
      <div class="user-card" aria-live="polite">
        <div class="name" id="uNome">Colaborador(a)</div>
        <div class="role" id="uFuncao">Fun√ß√£o</div>
      </div>
      <ul class="menu" id="menu">
        <!-- Cart√£o de Ponto com SUBMENU -->
        <li class="has-submenu menu-ponto-root" aria-haspopup="true" aria-expanded="false">
          <div class="row-head">
            <i class="fa-regular fa-calendar-days" aria-hidden="true"></i> Informa√ß√µes Ponto
            <i class="fa-solid fa-caret-down caret" aria-hidden="true"></i>
          </div>
          <ul class="submenu" id="submenuPonto" role="menu">
            <li data-tab="tabPonto" aria-controls="tabPonto" role="menuitem" class="active">
              <i class="fa-regular fa-calendar-days" aria-hidden="true"></i> Cart√£o de Ponto
            </li>
            <li data-tab="tabPontoJust" aria-controls="tabPontoJust" role="menuitem" data-roles="1,2">
              <i class="fa-regular fa-clipboard" aria-hidden="true"></i> Pontos Justificados
            </li>
          </ul>
        </li>
        <!-- Item normal: Incluir Ponto -->
        <li data-tab="tabIncluir"
            aria-controls="tabIncluir"
            data-roles="1,2,3,4">
          <i class="fa-solid fa-location-dot" aria-hidden="true"></i> Incluir Ponto
        </li>
        <!-- ‚úÖ Somente Admin ver√° (JS controla) -->
        <li data-tab="tabCadastroUsuario"
            aria-controls="tabCadastroUsuario"
            data-roles="1">
          <i class="fa-solid fa-user-plus" aria-hidden="true"></i> Cadastrar Usu√°rio
        </li>
        <!-- Item normal: Documentos & Assinaturas -->
        <li data-tab="tabDocs"
            aria-controls="tabDocs"
            data-roles="1,2">
          <i class="fa-regular fa-file-lines" aria-hidden="true"></i> Documentos & Assinaturas
        </li>
        <!-- Funcion√°rios com SUBMENU (igual j√° estava) -->
      <li class="has-submenu menu-func-root"
          aria-haspopup="true"
          aria-expanded="false"
          data-roles="1,2,3">
        <div class="row-head">
          <i class="fa-solid fa-users" aria-hidden="true"></i> Funcion√°rios
          <i class="fa-solid fa-caret-down caret" aria-hidden="true"></i>
        </div>
        <ul class="submenu" id="submenuFuncionarios" role="menu">
          <!-- Gest√£o de Funcion√°rios: Admin (1) e Gest√£o (2) -->
          <li data-tab="tabFuncGestao"
              aria-controls="tabFuncGestao"
              role="menuitem"
              data-roles="1,2">
            <i class="fa-solid fa-clipboard-user" aria-hidden="true"></i>
            Gest√£o de Funcion√°rios
          </li>
          <!-- Seguran√ßa do Trabalho: Admin (1), Gest√£o (2) e ST (3) -->
          <li data-tab="tabFuncionarios"
              aria-controls="tabFuncionarios"
              role="menuitem"
              data-roles="1,2,3">
            <i class="fa-solid fa-helmet-safety" aria-hidden="true"></i>
            Seguran√ßa do trabalho
          </li>
        </ul>
      </li>
    <!-- Benef√≠cios (submenu) -->
      <li class="has-submenu menu-benef-root"
          aria-haspopup="true"
          aria-expanded="false"
          data-roles="1,2">
        <div class="row-head">
          <i class="fa-solid fa-hand-holding-heart" aria-hidden="true"></i> Benef√≠cios
          <i class="fa-solid fa-caret-down caret" aria-hidden="true"></i>
        </div>

        <ul class="submenu" id="submenuBeneficios" role="menu">
          <!-- Vale Transporte -->
          <li role="menuitem"
              data-benef-open="VT"
              data-roles="1,2"
              tabindex="0">
            <i class="fa-solid fa-bus" aria-hidden="true"></i> Vale Transporte
          </li>

          <!-- Vale Refei√ß√£o -->
          <li role="menuitem"
              data-benef-open="VR"
              data-roles="1,2"
              tabindex="0">
            <i class="fa-solid fa-utensils" aria-hidden="true"></i> Vale Refei√ß√£o
          </li>
        </ul>
      </li>
    </ul>
      <div class="sidebar-mobile-footer">
        <button class="btn btn-light" id="btnCloseSidebar" type="button">
          <i class="fa-solid fa-arrow-left" aria-hidden="true"></i> Voltar
        </button>
      </div>
    </aside>

  <!-- Main -->
  <main>
    <div class="topbar">
      <div class="hello">
        Ol√°, <span id="helloNome">Colaborador(a)</span>
      </div>

      <div class="right">
        <!-- Rel√≥gio -->
        <span class="badge">
          <i class="fa-regular fa-clock" aria-hidden="true"></i>
          <span id="nowClock">--:--:--</span>
        </span>

        <!-- Bot√£o de alertas -->
        <button class="btn btn-light icon-btn"
                id="btnAlerts"
                title="Lembretes"
                aria-haspopup="dialog">
          <i class="fa-regular fa-bell" aria-hidden="true"></i>
          <span class="notif-dot" id="notifDot" hidden></span>
        </button>

        <!-- BOT√ÉO DO USU√ÅRIO (abre o dropdown) -->
        <button class="user-chip"
                id="btnUserMenu"
                type="button"
                aria-haspopup="true"
                aria-expanded="false">
          <span class="user-chip-initials" id="topUserInitials">
            <!-- √≠cone default de usu√°rio; se quiser, o JS pode trocar por iniciais -->
            <i class="fa-regular fa-user" aria-hidden="true"></i>
          </span>
        </button>

        <!-- DROPDOWN DO USU√ÅRIO -->
        <div class="user-menu"
            id="userMenu"
            aria-hidden="true">
          <div class="user-menu-header">
            <!-- Avatar do usu√°rio com borda em degrad√™ (clic√°vel p/ trocar foto) -->
            <button class="user-menu-avatar"
                    id="userMenuAvatar"
                    type="button"
                    title="Alterar foto">
              <i class="fa-regular fa-user" aria-hidden="true"></i>
            </button>

            <!-- Input escondido para upload da foto -->
            <input type="file"
                  id="userMenuAvatarInput"
                  accept="image/*"
                  hidden>

            <div class="user-menu-texts">
              <div class="user-menu-name" id="userMenuName">Usu√°rio</div>
              <div class="user-menu-email" id="userMenuEmail">email@rcr.com.br</div>
            </div>
          </div>

          <div class="user-menu-divider"></div>

          <!-- √öNICA A√á√ÉO: SAIR -->
          <button class="user-menu-item logout" id="btnUserLogout" type="button">
            <i class="fa-solid fa-arrow-right-from-bracket" aria-hidden="true"></i>
            <span>Sair</span>
          </button>
        </div>
      </div>
    </div>


    <!-- Cart√£o de Ponto -->
    <section id="tabPonto" class="tab active" role="region" aria-labelledby="hdrPonto">
      <div class="card">
        <div class="card-header" id="hdrPonto">Cart√£o de Ponto</div>
        <div class="card-body">

          <div class="filters">
            <div class="chip">
              <label for="pInicio">In√≠cio</label>
              <input type="date" id="pInicio"/>
            </div>
            <div class="chip">
              <label for="pFim">Fim</label>
              <input type="date" id="pFim"/>
            </div>
            <div class="chip">
              <label style="visibility:hidden">.</label>
              <button class="btn btn-primary" id="btnAplicarFiltro">
                <i class="fa fa-filter" aria-hidden="true"></i> Aplicar
              </button>
            </div>
            <div class="chip">
              <label style="visibility:hidden">.</label>
              <button class="btn btn-light" id="btnPeriodoAtual">
                <i class="fa-regular fa-calendar" aria-hidden="true"></i> 15 dias
              </button>
            </div>
            <div class="chip">
              <label style="visibility:hidden">.</label>
              <button class="btn btn-primary" id="btnExportPonto">
                <i class="fa-regular fa-file-pdf" aria-hidden="true"></i> Exportar PDF
              </button>
            </div>
          </div>

          <div class="kpis">
            <div class="kpi">
              <div class="title">Horas no per√≠odo</div>
              <div class="value" id="kHoras">00:00</div>
            </div>
            <div class="kpi">
              <div class="title">Saldo</div>
              <div class="value" id="kSaldo">00:00</div>
            </div>
            <div class="kpi">
              <div class="title">Dias com pend√™ncia</div>
              <div class="value" id="kPend">0</div>
            </div>
          </div>

          <div class="table-wrap">
            <table class="table" id="tPonto">
              <thead>
                <tr>
                  <th>Status</th><th>Data</th>
                  <th>Entrada 1</th><th>Sa√≠da 1</th>
                  <th>Entrada 2</th><th>Sa√≠da 2</th>
                  <th>Entrada 3</th><th>Sa√≠da 3</th>
                  <th>Saldo</th>
                </tr>
              </thead>
              <tbody><!-- via JS --></tbody>
            </table>
            <div class="muted-hint">
              Dica: clique em uma linha para ver <b>todos</b> os batimentos daquele dia.
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Pontos Justificados -->
    <section id="tabPontoJust" class="tab" role="region" aria-labelledby="hdrPontoJust">
      <div class="card">
        <div class="card-header" id="hdrPontoJust">Pontos Justificados</div>
        <div class="card-body">

          <!-- Filtros: funcion√°rio + per√≠odo -->
          <div class="filters">
            <div class="chip">
              <label for="justFunc">Funcion√°rio</label>
              <select id="justFunc">
                <option value="">Selecione‚Ä¶</option>
              </select>
            </div>

            <div class="chip">
              <label for="justInicio">In√≠cio</label>
              <input type="date" id="justInicio" />
            </div>

            <div class="chip">
              <label for="justFim">Fim</label>
              <input type="date" id="justFim" />
            </div>

            <div class="chip">
              <label style="visibility:hidden">.</label>
              <button class="btn btn-primary" id="btnFiltrarJust">
                <i class="fa-solid fa-filter" aria-hidden="true"></i> Buscar justificativas
              </button>
            </div>
          </div>

          <!-- Tabela de justificativas -->
          <div class="table-wrap">
            <table class="table ponto-just-table" id="tPontosJustificados">
              <thead>
                <tr>
                  <th>Data</th>
                  <th>Hor√°rio</th>
                  <th>Tipo</th>
                  <th>Justificativa</th>
                  <th>Status</th>
                  <th>A√ß√µes</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="6">
                    Selecione um funcion√°rio e per√≠odo para listar as justificativas.
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

     <!-- Incluir Ponto -->
    <section id="tabIncluir" class="tab" role="region" aria-labelledby="hdrIncluir">
                    <div class="card">
                      <div class="card-header" id="hdrIncluir">Incluir Ponto (geolocaliza√ß√£o)</div>

                      <div class="card-body">
                        <div id="map">
                          <div class="map-skeleton">Carregando mapa‚Ä¶</div>
                        </div>

                        <div class="inline-row">
                          <div class="chip">
                            <label>Data/Hora atual</label>
                            <div id="lblAgora" class="kv-strong">--/--/---- --:--:--</div>
                          </div>

                          <div class="chip">
                            <label>Coordenadas</label>
                            <div id="lblCoord" class="kv-strong">--</div>
                          </div>

                          <!-- A√á√ïES (lado a lado, como voc√™ pediu) -->
                          <div class="chip" style="flex: 1 1 320px; min-width: 280px;">
                            <label style="visibility:hidden">A√ß√µes</label>

                            <div style="display:flex; gap:10px; flex-wrap:wrap; justify-content:start;">
                              <button class="btn btn-ok" id="btnBaterPonto" type="button">
                                <i class="fa-regular fa-circle-dot" aria-hidden="true"></i>
                                Incluir Ponto
                              </button>

                              <button class="btn btn-light" id="btnAjustarPonto" type="button">
                                <i class="fa-solid fa-sliders" aria-hidden="true"></i>
                                Ajustar Ponto
                              </button>

                              <button class="btn btn-light" id="btnJustificarAusencia" type="button">
                                <i class="fa-solid fa-file-signature" aria-hidden="true"></i>
                                Justificar
                              </button>
                            </div>
                          </div>
                        </div>

                        <small class="muted" style="display:block;margin-top:10px;color:var(--muted);">
                          ‚Ä¢ ‚ÄúAjustar Ponto‚Äù use quando houve problema ao registrar o ponto. ‚Ä¢ ‚ÄúJustificar‚Äù use para aus√™ncia por dia/per√≠odo.
                        </small>
                      </div>
                    </div>
    </section>

                  <!-- ===================== MODAL: AJUSTAR PONTO ===================== -->
                  <div class="modal" id="modalAjustarPonto" style="display:none;">
                    <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="ajustePontoTitle">
                      <div class="modal-header" id="ajustePontoTitle">
                        Ajuste de Ponto
                        <button class="btn btn-ghost" id="btnFecharAjustarPonto" type="button" aria-label="Fechar">
                          <i class="fa-solid fa-xmark" aria-hidden="true"></i>
                        </button>
                      </div>
                  
                      <div class="modal-body">
                        <small class="muted" style="display:block;margin-bottom:12px;">
                          O ajuste de ponto deve ser utilizado caso voc√™ tenha tido algum problema para registrar o ponto.
                        </small>
                  
                        <div class="grid" style="max-width:520px;margin:0 auto;">
                          <div class="col">
                            <label for="ajData">Data</label>
                            <input id="ajData" type="date" class="input-dark">
                          </div>
                  
                          <div class="col">
                            <label for="ajE1">Entrada 1</label>
                            <input id="ajE1" type="time" class="input-dark">
                          </div>
                          <div class="col">
                            <label for="ajS1">Sa√≠da 1</label>
                            <input id="ajS1" type="time" class="input-dark">
                          </div>
                  
                          <div class="col">
                            <label for="ajE2">Entrada 2</label>
                            <input id="ajE2" type="time" class="input-dark">
                          </div>
                          <div class="col">
                            <label for="ajS2">Sa√≠da 2</label>
                            <input id="ajS2" type="time" class="input-dark">
                          </div>
                  
                          <div class="col">
                            <label for="ajE3">Entrada 3</label>
                            <input id="ajE3" type="time" class="input-dark">
                          </div>
                          <div class="col">
                            <label for="ajS3">Sa√≠da 3</label>
                            <input id="ajS3" type="time" class="input-dark">
                          </div>
                  
                          <div class="col">
                            <label for="ajObs">Observa√ß√£o</label>
                            <textarea id="ajObs" class="input-dark"
                              style="min-height:110px; padding-top:10px; line-height:1.35;"></textarea>
                          </div>
                        </div>
                      </div>
                  
                      <div class="modal-footer">
                        <button class="btn btn-light" id="btnCancelarAjustePonto" type="button">Cancelar</button>
                        <button class="btn btn-ok" id="btnEnviarAjustePonto" type="button">Enviar</button>
                      </div>
                    </div>
                  </div>
                  
                  <!-- ===================== MODAL: JUSTIFICAR AUS√äNCIA ===================== -->
                  <div class="modal" id="modalJustificarAusencia" style="display:none;">
                    <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="justAusTitle">
                      <div class="modal-header" id="justAusTitle">
                        Justificativa de Aus√™ncia
                        <button class="btn btn-ghost" id="btnFecharJustificarAusencia" type="button" aria-label="Fechar">
                          <i class="fa-solid fa-xmark" aria-hidden="true"></i>
                        </button>
                      </div>
                  
                      <div class="modal-body">
                        <small class="muted" style="display:block;margin-bottom:12px;">
                          A justificativa de aus√™ncia deve ser utilizada caso voc√™ fique ausente do trabalho por um dia ou um per√≠odo
                          espec√≠fico.
                        </small>
                  
                        <div class="grid" style="max-width:520px;margin:0 auto;">
                          <div class="col">
                            <label for="jusTipo">Aus√™ncia em</label>
                            <select id="jusTipo" class="select-dark">
                              <option value="dia">Dia Espec√≠fico</option>
                              <option value="periodo">Per√≠odo</option>
                            </select>
                          </div>
                  
                          <div class="col">
                            <label for="jusData">Data</label>
                            <input id="jusData" type="date" class="input-dark">
                          </div>
                  
                          <div class="col" id="jusPeriodoWrap" style="display:none;">
                            <label for="jusDataFim">Data final</label>
                            <input id="jusDataFim" type="date" class="input-dark">
                          </div>
                  
                          <div class="col">
                            <label for="jusPeriodo">Per√≠odo da Aus√™ncia</label>
                            <select id="jusPeriodo" class="select-dark">
                              <option value="dia_inteiro">Dia Inteiro</option>
                              <option value="manha">Manh√£</option>
                              <option value="tarde">Tarde</option>
                              <option value="horario">Hor√°rio espec√≠fico</option>
                            </select>
                          </div>
                  
                          <div class="col">
                            <label for="jusMotivo">Motivo</label>
                            <select id="jusMotivo" class="select-dark">
                              <option value="">Selecione...</option>
                              <option value="atestado">Atestado</option>
                              <option value="consulta">Consulta/Exame</option>
                              <option value="imprevisto">Imprevisto</option>
                              <option value="outros">Outros</option>
                            </select>
                          </div>
                  
                          <div class="col">
                            <label for="jusObs">Observa√ß√£o</label>
                            <textarea id="jusObs" class="input-dark"
                              style="min-height:110px; padding-top:10px; line-height:1.35;"></textarea>
                          </div>
                        </div>
                      </div>
                  
                      <div class="modal-footer">
                        <button class="btn btn-light" id="btnCancelarJustificativa" type="button">Cancelar</button>
                        <button class="btn btn-ok" id="btnEnviarJustificativa" type="button">Enviar</button>
                      </div>
                    </div>
                  </div>

    <!-- ===================== CADASTRAR USU√ÅRIO (ADMIN) ===================== -->
    <section id="tabCadastroUsuario" class="tab only-admin" role="region" aria-labelledby="hdrCadastroUsuario">
              <div class="card">
                <div class="card-header" id="hdrCadastroUsuario">Cadastrar Usu√°rio</div>

                <div class="card-body">
                  <div class="user-form-grid">

                    <div class="col">
                      <label for="usrLogin">Nome Login</label>
                      <input id="usrLogin" type="text" class="input-dark" placeholder="Seu nome de usu√°rio" autocomplete="username">
                    </div>

                    <div class="col">
                      <label for="usrEmail">Email</label>
                      <input id="usrEmail" type="email" class="input-dark" placeholder="voce@empresa.com" autocomplete="email">
                    </div>

                    <div class="col">
                      <label for="usrCPF">CPF</label>
                      <input id="usrCPF" type="text" class="input-dark" placeholder="000.000.000-00" inputmode="numeric" autocomplete="off">
                      <small class="tiny muted">CPF ser√°<b> Validado</b>.</small>
                    </div>

                    <div class="col">
                      <label for="usrTelefone">Telefone</label>
                      <input id="usrTelefone" type="text" class="input-dark" placeholder="(11) 90000-0000" inputmode="tel" autocomplete="tel">
                      <small class="tiny muted">Telefone ser√°<b> Validado</b>.</small>
                    </div>

                    <div class="col">
                      <label for="usrSenha">Senha</label>
                      <input id="usrSenha" type="password" class="input-dark" placeholder="Crie uma senha" autocomplete="new-password">
                    </div>

                    <div class="col">
                      <label for="usrSenha2">Confirmar Senha</label>
                      <input id="usrSenha2" type="password" class="input-dark" placeholder="Repita a senha" autocomplete="new-password">
                    </div>

                    <div class="col" style="grid-column:1/-1;">
                      <label for="usrPerfil">Perfil de acesso</label>
                      <select id="usrPerfil" class="select-dark">
                        <option value="1">Administrador(a)</option>
                        <option value="2">Gest√£o</option>
                        <option value="3">Seguran√ßa do Trabalho</option>
                        <option value="4">Funcion√°rio(a)</option>
                      </select>
                    </div>

                  </div>

                  <div class="inline-row user-form-actions">
                    <button class="btn btn-light" id="btnUsrLimpar" type="button">
                      <i class="fa-solid fa-eraser" aria-hidden="true"></i> Limpar
                    </button>

                    <button class="btn btn-primary" id="btnUsrSalvar" type="button">
                      <i class="fa-regular fa-floppy-disk" aria-hidden="true"></i> Cadastrar Usu√°rio
                    </button>
                  </div>

                  <div id="usrStatus" class="filehint" style="margin-top:12px;">
                    Preencha os dados e clique em ‚ÄúCadastrar Usu√°rio‚Äù.
                  </div>
                </div>
              </div>
    </section>

    <!-- Documentos & Assinaturas -->
    <section id="tabDocs" class="tab" role="region" aria-labelledby="hdrDocs">
            <div class="card" style="height:100%;min-height:580px">
              <div class="card-header" id="hdrDocs">Documentos &amp; Assinaturas</div>

              <div class="card-body docs-card-body" style="padding:0;height:calc(100% - 48px)">

                <!-- ================== SUB-ABAS DE DOCUMENTOS ================== -->
                <div class="docs-tabs" role="tablist" aria-label="Documentos">
                  <button
                    type="button"
                    class="btn btn-light docs-tab-btn active"
                    data-target="#paneDocsGerar"
                  >
                    <i class="fa-regular fa-file-lines" aria-hidden="true"></i>
                    Gerar documentos
                  </button>

                  <button
                    type="button"
                    class="btn btn-light docs-tab-btn"
                    data-target="#paneDocsAssinar"
                  >
                    <i class="fa-solid fa-signature" aria-hidden="true"></i>
                    Assinar documentos (Clicksign)
                  </button>
                </div>

                <!-- ================== PANE 1: GERAR DOCUMENTOS (SEU FLUXO ATUAL) ================== -->
                <div class="docs-pane active" id="paneDocsGerar" role="tabpanel" aria-label="Gerar documentos">
                  <!-- ================== Documentos & Assinaturas: HERO ================== -->
                  <div id="docs-sign-root" class="docs-shell">
                    <div class="docs-hero">
                      <!-- Bot√£o "Templates" (abre o gerenciador de templates) -->
                      <button id="btn-templates" type="button" class="btn secondary">Templates</button>
                      <!-- Bot√£o Gerar documento -->
                      <section class="docs-cta-card" role="region" aria-labelledby="docs-cta-title">
                        <h2 id="docs-cta-title" class="sr-only">Documentos &amp; Assinaturas</h2>
                        <button id="btn-open" type="button" class="btn_doc">Gerar documento</button>
                      </section>
                    </div>

                    <footer class="docs-footer">
                      ¬© Atrium ‚Ä¢ <span class="grad">2025</span>
                    </footer>

                    <!-- MODAL WIZARD GERAR DOCUMENTO (resiz√°vel) -->
                    <div id="wizard" class="backdrop" role="dialog" aria-modal="true" aria-hidden="true">
                      <div class="modal" id="wizardModal">
                        <div class="modal-h">Gera√ß√£o de documentos</div>
                        <div class="modal-b">
                          <!-- STEP 1 -->
                          <div id="step1" class="grid grid-2">
                            <div>
                              <label for="template">Selecione o template</label>
                              <select id="template" class="select-dark"></select>
                              <small class="tiny">Crie/edite templates no bot√£o ‚ÄúTemplates‚Äù.</small>
                            </div>

                            <div>
                              <label>Vincular funcion√°rio?</label>
                              <div class="radio-inline">
                                <label><input type="radio" name="vinc" value="sim" checked> Sim</label>
                                <label><input type="radio" name="vinc" value="nao"> N√£o</label>
                              </div>
                            </div>

                            <div id="func-wrap">
                              <label for="func">Escolha o funcion√°rio</label>
                              <select id="func" class="select-dark"></select>
                            </div>

                            <div class="panel" style="grid-column:1/-1">
                              <small class="muted">
                                Vari√°veis:
                                <code>{nome}</code>, <code>{cpf}</code>, <code>{endereco.cidade}</code>,
                                <code>{salario|money}</code>, <code>{admissao|date}</code>,
                                <code>{nome|upper}</code>, <code>{hoje}</code>.
                              </small>
                            </div>
                          </div>

                          <!-- STEP 2 -->
                          <div id="step2" style="display:none;">
                            <div class="cols">
                              <div class="panel">
                                <h4>Vari√°veis detectadas</h4>
                                <div id="vars"></div>
                                <hr style="border-color:rgba(255,255,255,.08);margin:10px 0">
                                <label class="radio-inline" style="gap:8px;">
                                  <input type="checkbox" id="chk-preview" checked> Pr√©-visualizar com dados do funcion√°rio
                                </label>
                                <div class="panel" style="margin-top:10px;">
                                  <small class="muted">
                                    Clique em uma vari√°vel para inserir no cursor do editor.
                                  </small>
                                </div>

                                <!-- ======= Configura√ß√µes de Layout ======= -->
                                <div class="panel" style="margin-top:12px;">
                                  <h4>Configura√ß√µes de layout</h4>
                                  <div class="grid">
                                    <div>
                                      <label for="ly-font-family">Fonte</label>
                                      <select id="ly-font-family" class="select-dark">
                                        <option value="Arial, Helvetica, sans-serif">Arial / Helvetica</option>
                                        <option value="Times New Roman, Times, serif">Times New Roman</option>
                                        <option value="Calibri, Arial, Helvetica, sans-serif">Calibri</option>
                                        <option value="Cambria, Georgia, 'Times New Roman', Times, serif">Cambria</option>
                                        <option value="Roboto, Arial, Helvetica, sans-serif">Roboto</option>
                                      </select>
                                    </div>
                                    <div>
                                      <label for="ly-font-size">Tamanho base da fonte (px)</label>
                                      <input id="ly-font-size" type="number" class="input-dark" min="8" max="20" step="1" />
                                    </div>
                                    <div>
                                      <label for="ly-line-height">Altura de linha</label>
                                      <input id="ly-line-height" type="number" class="input-dark" min="1" max="2" step="0.05" />
                                    </div>
                                    <div>
                                      <label for="ly-p-spacing">Espa√ßo entre par√°grafos (px)</label>
                                      <input id="ly-p-spacing" type="number" class="input-dark" min="0" max="40" step="1" />
                                    </div>

                                    <div>
                                      <label for="ly-h1">Tamanho H1 (x da base)</label>
                                      <input id="ly-h1" type="number" class="input-dark" min="1.0" max="3" step="0.05" />
                                    </div>
                                    <div>
                                      <label for="ly-h2">Tamanho H2 (x da base)</label>
                                      <input id="ly-h2" type="number" class="input-dark" min="1.0" max="3" step="0.05" />
                                    </div>
                                    <div>
                                      <label for="ly-h3">Tamanho H3 (x da base)</label>
                                      <input id="ly-h3" type="number" class="input-dark" min="1.0" max="3" step="0.05" />
                                    </div>

                                    <div>
                                      <label for="ly-page-format">Formato da p√°gina</label>
                                      <select id="ly-page-format" class="select-dark">
                                        <option value="a4">A4</option>
                                        <option value="letter">Carta (Letter)</option>
                                      </select>
                                    </div>
                                    <div>
                                      <label for="ly-orientation">Orienta√ß√£o</label>
                                      <select id="ly-orientation" class="select-dark">
                                        <option value="p">Retrato</option>
                                        <option value="l">Paisagem</option>
                                      </select>
                                    </div>

                                    <div>
                                      <label for="ly-mt">Margem superior (mm)</label>
                                      <input id="ly-mt" type="number" class="input-dark" min="0" max="50" step="1" />
                                    </div>
                                    <div>
                                      <label for="ly-mr">Margem direita (mm)</label>
                                      <input id="ly-mr" type="number" class="input-dark" min="0" max="50" step="1" />
                                    </div>
                                    <div>
                                      <label for="ly-mb">Margem inferior (mm)</label>
                                      <input id="ly-mb" type="number" class="input-dark" min="0" max="50" step="1" />
                                    </div>
                                    <div>
                                      <label for="ly-ml">Margem esquerda (mm)</label>
                                      <input id="ly-ml" type="number" class="input-dark" min="0" max="50" step="1" />
                                    </div>
                                  </div>

                                  <div class="panel" style="margin-top:12px;">
                                    <div class="row">
                                      <label class="radio-inline" style="gap:8px;">
                                        <input type="checkbox" id="ly-logo-enabled"> Inserir logo no topo
                                      </label>
                                    </div>
                                    <div class="grid" style="margin-top:8px;">
                                      <div>
                                        <label for="ly-logo-size">Tamanho do logo (px)</label>
                                        <input id="ly-logo-size" type="number" class="input-dark" min="24" max="600" step="1" />
                                      </div>
                                      <div>
                                        <label for="ly-logo-align">Alinhamento do logo</label>
                                        <select id="ly-logo-align" class="select-dark">
                                          <option value="left">Esquerda</option>
                                          <option value="center">Centro</option>
                                          <option value="right">Direita</option>
                                        </select>
                                      </div>
                                      <div>
                                        <label for="ly-logo-space">Espa√ßo abaixo do logo (px)</label>
                                        <input id="ly-logo-space" type="number" class="input-dark" min="0" max="80" step="1" />
                                      </div>
                                      <div>
                                        <label for="ly-logo-file">Logo (imagem)</label>
                                        <div class="file-input">
                                          <input id="ly-logo-file" type="file" accept="image/*" hidden />
                                          <button id="ly-logo-file-btn" type="button" class="input-like">
                                            <span>Selecionar imagem</span>
                                            <span class="tiny">üñºÔ∏è</span>
                                          </button>
                                          <div id="ly-logo-file-info" class="tiny file-name">Nenhum arquivo selecionado</div>
                                        </div>
                                      </div>
                                    </div>

                                    <div class="row" style="margin-top:10px;">
                                      <label class="radio-inline" style="gap:8px;">
                                        <input type="checkbox" id="ly-logo-resize-first" checked>
                                        Redimensionar primeira imagem do conte√∫do (usa o tamanho do logo)
                                      </label>
                                    </div>
                                  </div>

                                  <div class="row" style="margin-top:10px;">
                                    <button id="ly-reset" class="btn secondary">Resetar</button>
                                    <div style="display:flex;gap:8px;">
                                      <button id="ly-save" class="btn">Salvar como padr√£o</button>
                                    </div>
                                  </div>
                                </div>
                                <!-- ======= /Configura√ß√µes de Layout ======= -->
                              </div>

                              <div>
                                <div class="toolbar">
                                  <button class="tb-btn" data-cmd="bold"><b>N</b></button>
                                  <button class="tb-btn" data-cmd="italic"><i>I</i></button>
                                  <button class="tb-btn" data-cmd="underline"><u>S</u></button>
                                  <button class="tb-btn" data-cmd="insertUnorderedList">‚Ä¢ Lista</button>
                                  <button class="tb-btn" data-cmd="insertOrderedList">1. Lista</button>
                                  <button class="tb-btn" id="btn-clear">Limpar formata√ß√£o</button>
                                </div>
                                <div id="editor" class="editor" contenteditable="true"></div>
                                <div id="preview" class="preview"></div>
                              </div>
                            </div>
                          </div>
                        </div>

                        <div class="modal-f">
                          <div style="display:flex;gap:8px;flex-wrap:wrap">
                            <button id="btn-back" class="btn secondary">Voltar</button>
                          </div>
                          <div style="display:flex;gap:8px;flex-wrap:wrap">
                            <button id="btn-close" class="btn secondary">Fechar</button>
                            <button id="btn-next" class="btn">Avan√ßar</button>
                            <button id="btn-concluir" class="btn" style="display:none;">Concluir (PDF)</button>
                          </div>
                        </div>

                        <!-- handles de resize -->
                        <div class="resizer-e" id="wizardResizeE"></div>
                        <div class="resizer-se" id="wizardResizeSE"></div>
                      </div>
                    </div>

                    <!-- MODAL GERENCIAR TEMPLATES -->
                    <div id="tplModal" class="backdrop" role="dialog" aria-modal="true" aria-hidden="true">
                      <div class="modal" style="width:min(1100px,96vw)">
                        <div class="modal-h row">
                          <span>Templates</span>
                          <button id="btn-close-tpl" class="btn secondary">Fechar</button>
                        </div>
                        <div class="modal-b">
                          <!-- Lista -->
                          <div id="tplListView">
                            <div class="row" style="margin-bottom:10px;">
                              <h3 style="margin:0">Meus templates</h3>
                              <button id="btn-new-tpl" class="btn">Criar template</button>
                            </div>
                            <div class="list" id="tplList"></div>
                            <div class="panel" style="margin-top:10px;">
                              <small class="muted">
                                Templates ‚Äúpadr√£o‚Äù n√£o podem ser apagados. Para editar, use ‚ÄúDuplicar‚Äù e edite a c√≥pia.
                              </small>
                            </div>
                          </div>

                          <!-- Criar/Editar -->
                          <div id="tplEditView" style="display:none;">
                            <div class="grid grid-2">
                              <div>
                                <label for="tplName">Nome do template</label>
                                <input id="tplName" type="text" class="input-dark" placeholder="Ex: Contrato CLT ‚Äì Loja SP" />
                              </div>

                              <div>
                                <label for="docxTpl">Importar Word (.docx)</label>
                                <div class="file-input">
                                  <input id="docxTpl" type="file" accept=".docx" hidden />
                                  <button id="docxTplBtn" type="button" class="input-like">
                                    <span>Selecionar arquivo .docx</span>
                                    <span class="tiny">üìÑ</span>
                                  </button>
                                  <div id="docxTplInfo" class="tiny file-name">Nenhum arquivo selecionado</div>
                                </div>
                                <small class="tiny">
                                  A importa√ß√£o mant√©m a formata√ß√£o (t√≠tulos, listas, negrito etc.).
                                </small>
                              </div>

                              <div class="panel" style="grid-column:1/-1">
                                <small class="muted">
                                  Vari√°veis:
                                  <code>{nome}</code>, <code>{cpf}</code>, <code>{endereco.cidade}</code>,
                                  <code>{salario|money}</code>, <code>{admissao|date}</code>,
                                  <code>{nome|upper}</code>, <code>{hoje}</code>.
                                </small>
                              </div>
                            </div>

                            <div class="cols" style="margin-top:12px;">
                              <div class="panel">
                                <h4>Vari√°veis detectadas</h4>
                                <div id="tplVars"></div>
                              </div>
                              <div>
                                <div class="toolbar">
                                  <button class="tb-btn" data-cmd="bold"><b>N</b></button>
                                  <button class="tb-btn" data-cmd="italic"><i>I</i></button>
                                  <button class="tb-btn" data-cmd="underline"><u>S</u></button>
                                  <button class="tb-btn" data-cmd="insertUnorderedList">‚Ä¢ Lista</button>
                                  <button class="tb-btn" data-cmd="insertOrderedList">1. Lista</button>
                                  <button class="tb-btn" id="btn-clear-tpl">Limpar formata√ß√£o</button>
                                </div>
                                <div id="tplEditor" class="editor" contenteditable="true"></div>
                              </div>
                            </div>

                            <div class="row" style="margin-top:12px;">
                              <button id="btn-back-list" class="btn secondary">Cancelar</button>
                              <div style="display:flex;gap:8px;">
                                <button id="btn-save-tpl" class="btn">Salvar template</button>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                    <!-- √Årea oculta para render do PDF -->
                    <div id="print-area"></div>
                  </div>
                </div>

                <!-- ================== PANE 2: ASSINAR DOCUMENTOS (CLICKSIGN) ================== -->
                <div class="docs-pane" id="paneDocsAssinar" role="tabpanel" aria-label="Assinar documentos">
                  <div class="docs-clicksign-shell">

                    <div class="docs-clicksign-header">
                      <div class="cs-title-row">
                        <h3>Assinar documentos com Clicksign</h3>
                        <span class="cs-pill">Integra√ß√£o</span>
                      </div>

                      <p class="muted">
                        Selecione o documento e vincule ao funcion√°rio. Os dados do signat√°rio ser√£o preenchidos automaticamente.
                        Em seguida, envie para assinatura e depois baixe o PDF assinado.
                      </p>

                      <div class="cs-header-hints">
                        <div class="cs-hint">
                          <b>Dica:</b> salve no seu banco as chaves retornadas (document/envelope/signer) para consultar status e baixar depois.
                        </div>
                        <div class="cs-hint">
                          <b>Canal de envio:</b> WhatsApp/Gmail/SMS podem ser disparados pelo seu sistema ap√≥s receber o <i>signUrl</i>.
                        </div>
                      </div>
                    </div>

                    <div class="docs-clicksign-grid">

                      <!-- Coluna esquerda: preparar e enviar -->
                      <div class="panel docs-clicksign-panel" aria-label="Passo 1: Vincular e enviar">
                        <div class="cs-step-head">
                          <span class="cs-badge">Passo 1</span>
                          <h4>Vincular e enviar para assinatura</h4>
                        </div>

                        <div class="cs-section">
                          <label for="csDocSelect">Documento gerado</label>
                          <select id="csDocSelect" class="select-dark">
                            <option value="">Selecione um documento‚Ä¶</option>
                          </select>

                          <label for="csFuncSelect" style="margin-top:10px;">Funcion√°rio</label>
                          <select id="csFuncSelect" class="select-dark">
                            <option value="">Selecione um funcion√°rio‚Ä¶</option>
                          </select>
                        </div>

                        <div class="cs-divider"></div>

                        <div class="cs-section">
                          <div class="grid">
                            <div class="col">
                              <label for="csSignerName">Nome do signat√°rio</label>
                              <input id="csSignerName" type="text" class="input-dark" placeholder="Nome completo" readonly>
                            </div>

                            <div class="col">
                              <label for="csSignerEmail">E-mail do signat√°rio</label>
                              <input id="csSignerEmail" type="email" class="input-dark" placeholder="colaborador@empresa.com" readonly>
                            </div>

                            <div class="col">
                              <label for="csSignerPhone">Celular do signat√°rio</label>
                              <input id="csSignerPhone" type="text" class="input-dark" placeholder="(DD) XXXXX-XXXX" readonly>
                            </div>
                          </div>
                        </div>

                        <div class="cs-divider"></div>

                        <div class="cs-section">
                          <div class="grid">
                            <div class="col">
                              <label>Enviar link por</label>

                              <!-- Bot√µes (3 op√ß√µes) -->
                              <div class="cs-segment" role="group" aria-label="Canal de envio do link">
                                <button type="button" class="cs-seg-btn active" data-channel="whatsapp" aria-pressed="true">
                                  <i class="fa-brands fa-whatsapp" aria-hidden="true"></i>
                                  WhatsApp
                                </button>
                                <button type="button" class="cs-seg-btn" data-channel="gmail" aria-pressed="false">
                                  <i class="fa-solid fa-envelope" aria-hidden="true"></i>
                                  Gmail
                                </button>
                                <button type="button" class="cs-seg-btn" data-channel="sms" aria-pressed="false">
                                  <i class="fa-solid fa-comment-sms" aria-hidden="true"></i>
                                  SMS
                                </button>
                              </div>

                              <!-- Mant√©m o select original (pra seu JS/back) -->
                              <select id="csSendChannel" class="select-dark cs-hidden">
                                <option value="email">E-mail (padr√£o Clicksign)</option>
                                <option value="whatsapp" selected>WhatsApp</option>
                                <option value="gmail">Gmail</option>
                                <option value="sms">SMS</option>
                              </select>

                              <small class="tiny muted cs-helper">
                                WhatsApp/SMS exigem integra√ß√£o externa (WhatsApp Business API / provedor de SMS).
                              </small>
                            </div>

                            <div class="col">
                              <label for="csAuthMethod">Autentica√ß√£o</label>
                              <select id="csAuthMethod" class="select-dark">
                                <option value="email">Token por e-mail</option>
                                <option value="whatsapp">Token por WhatsApp</option>
                                <option value="sms">Token por SMS</option>
                              </select>
                              <small class="tiny muted cs-helper">
                                M√©todo de autentica√ß√£o pode ser diferente do canal de envio do link.
                              </small>
                            </div>
                          </div>
                        </div>

                        <div class="cs-section">
                          <label for="csMsg">Mensagem (opcional)</label>
                          <textarea id="csMsg" class="input-dark cs-textarea"
                            placeholder="Ex.: Ol√°, segue o link para assinatura do seu documento."></textarea>
                        </div>

                        <div class="cs-actions">
                          <button id="btnCsEnviar" type="button" class="btn btn-primary">
                            <i class="fa-solid fa-paper-plane" aria-hidden="true"></i>
                            Enviar para Clicksign
                          </button>

                          <button id="btnCsLimparVinculo" type="button" class="btn btn-light">
                            <i class="fa-solid fa-rotate-left" aria-hidden="true"></i>
                            Limpar v√≠nculo
                          </button>
                        </div>

                        <div class="cs-note tiny muted">
                          Ao enviar, salve no banco: <b>documentKey</b>, <b>envelopeKey</b> e o <b>signUrl</b>.
                        </div>
                      </div>

                      <!-- Coluna direita: status + baixar -->
                      <div class="panel docs-clicksign-panel" aria-label="Passo 2: Acompanhar e baixar">
                        <div class="cs-step-head">
                          <span class="cs-badge">Passo 2</span>
                          <h4>Acompanhar e baixar</h4>
                        </div>

                        <div class="cs-section">
                          <label for="csEnvelopeKey">Chave do envelope (opcional)</label>
                          <input id="csEnvelopeKey" type="text" class="input-dark"
                                placeholder="Ex.: envelope_key (se voc√™ salvar)">

                          <label for="csDocKey" style="margin-top:8px;">Chave/c√≥digo do documento (Clicksign)</label>
                          <input id="csDocKey" type="text" class="input-dark"
                                placeholder="Ex.: document_key retornada pela API">
                        </div>

                        <div class="cs-actions">
                          <button id="btnCsConsultar" type="button" class="btn btn-light">
                            <i class="fa-solid fa-rotate" aria-hidden="true"></i>
                            Consultar status
                          </button>

                          <button id="btnCsBaixar" type="button" class="btn btn-ok">
                            <i class="fa-solid fa-download" aria-hidden="true"></i>
                            Baixar PDF assinado
                          </button>
                        </div>

                        <div class="cs-note tiny muted">
                          Se voc√™ guardar as chaves no banco, voc√™ nem precisa digitar aqui ‚Äî pode popular automaticamente ao selecionar documento/funcion√°rio.
                        </div>
                      </div>
                    </div>

                    <div id="csStatus" class="cs-status cs-status--info" style="margin-top:12px;">
                      Nenhuma a√ß√£o realizada ainda.
                    </div>
                  </div>
                </div>

              </div>
            </div>
    </section>

    <!-- GEST√ÉO DE FUNCION√ÅRIOS -->
    <section id="tabFuncGestao" class="tab" role="region" aria-labelledby="hdrFuncGestao">
      <div class="card">
        <div class="card-header" id="hdrFuncGestao">Gest√£o de Funcion√°rios</div>

        <div class="card-body">

          <!-- (Bloco de cadastro √© aberto em modal) -->
          <div class="gestao-cadastro-wrap">
            <div class="gestao-cadastro">
              <div class="card flat">
                <div class="card-header">Cadastro de Funcion√°rios</div>

                <div class="card-body">

                  <!-- FOTO (avatar grande + bot√£o escolher foto) -->
                  <div class="row">
                    <div class="col" style="max-width:260px">
                      <label class="avatar-label">Foto do funcion√°rio</label>

                      <div class="avatar-wrapper">
                        <!-- ‚úÖ avatar do CADASTRO (n√£o use .emp-avatar aqui) -->
                        <div class="cad-avatar cad-avatar-large" aria-label="Pr√©-visualiza√ß√£o da foto">
                          <div class="cad-avatar-inner">
                            <img
                              id="cadFotoPreview"
                              class="cad-avatar-img"
                              src="assets/img/user_teste.svg"
                              alt="Foto do funcion√°rio"
                            >
                          </div>
                        </div>

                        <!-- input real escondido -->
                        <input type="file" id="cadFoto" accept="image/*" style="display:none">

                        <!-- bot√£o estilizado pra escolher a foto -->
                        <label for="cadFoto" class="btn btn-light avatar-upload-btn" role="button" tabindex="0">
                          <i class="fa-regular fa-image" aria-hidden="true"></i>
                          <span>Escolher foto</span>
                        </label>
                      </div>
                    </div>
                  </div>

                  <!-- NOME / FUN√á√ÉO -->
                  <div class="row">
                    <div class="col">
                      <label for="cadNome">Nome</label>
                      <input type="text" id="cadNome" placeholder="Nome completo">
                    </div>
                    <div class="col">
                      <label for="cadFuncao">Fun√ß√£o</label>
                      <input type="text" id="cadFuncao" placeholder="Cargo/Fun√ß√£o">
                    </div>
                  </div>

                  <!-- RG / CPF / CEL / E-MAIL / IDADE -->
                  <div class="row">
                    <div class="col">
                      <label for="cadRG">RG</label>
                      <input type="text" id="cadRG" placeholder="00.000.000-0">
                    </div>
                    <div class="col">
                      <label for="cadCPF">CPF</label>
                      <input type="text" id="cadCPF" placeholder="000.000.000-00">
                    </div>
                    <div class="col">
                      <label for="cadCell">Celular</label>
                      <input
                        type="text"
                        id="cadCell"
                        placeholder="(DD) XXXXX-XXXX"
                        inputmode="tel"
                        autocomplete="tel"
                      >
                    </div>
                    <div class="col">
                      <label for="cadEmail">E-mail</label>
                      <input
                        type="email"
                        id="cadEmail"
                        placeholder="ex: colaborador@empresa.com"
                        inputmode="email"
                        autocomplete="email"
                        spellcheck="false"
                      >
                    </div>
                    <div class="col">
                      <label for="cadIdade">Idade</label>
                      <input type="number" id="cadIdade" min="0" placeholder="0">
                    </div>
                  </div>

                  <!-- ADMISS√ÉO / SAL√ÅRIO -->
                  <div class="row" id="wrapAdmissaoSalario">
                    <div class="col">
                      <label for="cadAdmissao">Data de admiss√£o</label>
                      <input type="date" id="cadAdmissao">
                    </div>
                    <div class="col">
                      <label for="cadSalario">Sal√°rio (R$)</label>
                      <input type="number" id="cadSalario" min="0" step="0.01" placeholder="0,00">
                    </div>
                  </div>

                  <!-- VALORES VR / VT -->
                  <div class="row benefit-prices">
                    <div class="col">
                      <label for="cadVtUnit">Tarifa VT (R$)</label>
                      <input type="number" id="cadVtUnit" step="0.01" min="0" placeholder="ex.: 5,00">
                    </div>
                    <div class="col">
                      <label for="cadVrDaily">Valor di√°rio VR (R$)</label>
                      <input type="number" id="cadVrDaily" step="0.01" min="0" placeholder="ex.: 25,00">
                    </div>
                  </div>

                  <!-- CARGO (mantido pro JS, mas escondido via CSS se quiser) -->
                  <div class="row" id="wrapCargoField">
                    <div class="col">
                      <label for="cadCargo">Cargo</label>
                      <input type="text" id="cadCargo" placeholder="Ex.: Analista, Engenheiro">
                    </div>
                  </div>

                  <!-- VR / VT -->
                  <div class="row">
                    <div class="col">
                      <label>Benef√≠cios</label>
                      <div class="benefit-toggles" id="benefitToggleRow">
                        <label>
                          <input type="checkbox" id="cadOptVR">
                          VR
                        </label>
                        <label>
                          <input type="checkbox" id="cadOptVT">
                          VT
                        </label>
                      </div>
                      <div class="vr-help">
                        Marque as op√ß√µes desejadas. Voc√™ pode editar regras em <b>Benef√≠cios</b> depois.
                      </div>
                    </div>
                  </div>

                  <!-- TIPO DE CONTRATO: CLT / PJ -->
                  <div class="row">
                    <div class="col">
                      <label>Tipo de contrato</label>
                      <div class="benefit-toggles" id="contractToggleRow">
                        <label>
                          <input type="radio" name="cadTipoContrato" id="cadTipoContratoCLT" value="CLT">
                          CLT
                        </label>
                        <label>
                          <input type="radio" name="cadTipoContrato" id="cadTipoContratoPJ" value="PJ">
                          PJ
                        </label>
                      </div>
                      <div class="vr-help">
                        Selecione o tipo de contrato do colaborador.
                      </div>
                    </div>
                  </div>

                  <!-- DOCUMENTO + BOT√ïES -->
                  <div class="row">
                    <div class="col">
                      <label for="cadDocumento">Documento (arquivo)</label>
                      <input type="file" id="cadDocumento">
                    </div>
                    <div class="col">
                      <label style="visibility:hidden">.</label>
                      <div class="inline-row">
                        <button class="btn btn-primary" id="btnSalvarCadastro" type="button">
                          <i class="fa-regular fa-floppy-disk" aria-hidden="true"></i> Salvar cadastro
                        </button>
                        <button class="btn btn-light" id="btnLimparCadastro" type="button">
                          <i class="fa-solid fa-eraser" aria-hidden="true"></i> Limpar
                        </button>
                      </div>
                    </div>
                  </div>

                </div><!-- /.card-body -->
              </div><!-- /.card -->
            </div><!-- /.gestao-cadastro -->
          </div><!-- /.gestao-cadastro-wrap -->

          <!-- BUSCA (Gest√£o) -->
          <div class="emp-tools centered" id="empToolsGestao">
            <div class="search-group">
              <input type="text" id="funcSearchGestao" placeholder="Pesquisar funcion√°rio‚Ä¶ (digite para filtrar)">
              <button class="btn btn-light" id="funcSearchGestaoBtn" title="Pesquisar" type="button">
                <i class="fa-solid fa-magnifying-glass" aria-hidden="true"></i>
              </button>
              <button class="btn btn-light" id="funcClearGestao" type="button">
                <i class="fa-solid fa-xmark" aria-hidden="true"></i> Limpar
              </button>
            </div>
          </div>

          <!-- Bot√£o Cadastro de Usu√°rio -->
          <div class="gestao-actions-left">
            <button class="btn btn-primary" id="btnAbrirCadastro" type="button">
              <i class="fa-solid fa-user-plus" aria-hidden="true"></i> Cadastro de Funcion√°rio
            </button>
          </div>

          <!-- Host para a grade -->
          <div id="empGridHostGestao"></div>

        </div><!-- /.card-body -->
      </div><!-- /.card -->
    </section>
    <!-- FIM GEST√ÉO -->

    <!-- GERENCIAR FUNCION√ÅRIOS -->
    <section id="tabFuncionarios" class="tab" role="region" aria-labelledby="hdrFuncionarios">
          <div class="card">
            <div class="card-header" id="hdrFuncionarios">Funcion√°rios</div>
            <div class="card-body">

              <!-- Busca simples -->
              <div class="emp-tools centered">
                <div class="search-group">
                  <input type="text" id="funcSearch" placeholder="Pesquisar funcion√°rio‚Ä¶ (digite para filtrar)">
                  <button class="btn btn-light" id="funcSearchBtn" title="Pesquisar">
                    <i class="fa-solid fa-magnifying-glass" aria-hidden="true"></i>
                  </button>
                  <button class="btn btn-light" id="funcClear">
                    <i class="fa-solid fa-xmark" aria-hidden="true"></i> Limpar
                  </button>
                </div>
              </div>

              <!-- Grade de funcion√°rios (preenchida via JS) -->
              <div class="emp-grid" id="empGrid"><!-- via JS --></div>

            </div>
          </div>
    </section>

    <!-- Benef√≠cios ‚Äî VT 
    <section id="tabVT" class="tab" role="region" aria-labelledby="hdrVT">

    </section>

    -- Benef√≠cios ‚Äî VR 
    <section id="tabVR" class="tab" role="region" aria-labelledby="hdrVR">
          <div class="card">
            <div class="card-header" id="hdrVR">Benef√≠cios ‚Äî Vale Refei√ß√£o</div>
            <div class="card-body">
              <div class="kpis">
                <div class="kpi">
                  <div class="title">Ades√µes (VR)</div>
                  <div class="value" id="vrKAdesoes">0</div>
                </div>
                <div class="kpi">
                  <div class="title">Custo total do benef√≠cio</div>
                  <div class="value" id="vrKBeneficio">R$ 0,00</div>
                </div>
                <div class="kpi">
                  <div class="title">Desconto total (func.)</div>
                  <div class="value" id="vrKDesconto">R$ 0,00</div>
                </div>
                <div class="kpi">
                  <div class="title">Custo l√≠quido p/ empresa</div>
                  <div class="value" id="vrKLiquido">R$ 0,00</div>
                </div>

                <div class="export-actions">
                  <button class="btn btn-light" id="btnExportVRCSV">
                    <i class="fa-regular fa-file-excel" aria-hidden="true"></i> Exportar Excel (CSV)
                  </button>
                  <button class="btn btn-primary" id="btnExportVRPDF">
                    <i class="fa-regular fa-file-pdf" aria-hidden="true"></i> Exportar PDF
                  </button>
                </div>
              </div>

              <div class="row" style="align-items:flex-end">
                <div class="col" style="max-width:220px">
                  <label for="vrDaily">Valor di√°rio (R$)</label>
                  <input type="number" step="0.01" min="0" id="vrDaily" placeholder="ex.: 25.00">
                </div>
                <div class="col" style="max-width:220px">
                  <label for="vrDays">Dias √∫teis / m√™s</label>
                  <input type="number" min="0" max="31" id="vrDays" placeholder="ex.: 22">
                </div>
                <div class="col" style="max-width:220px">
                  <label for="vrPct">% desconto sobre sal√°rio</label>
                  <input type="number" min="0" max="100" step="0.01" id="vrPct" placeholder="6">
                </div>
                <div class="col" style="max-width:220px">
                  <label for="vrCreditDay">Dia do cr√©dito (geral)</label>
                  <input type="number" min="1" max="31" id="vrCreditDay" placeholder="1 a 31">
                </div>
              </div>

              <div class="row" style="align-items:center">
                <div class="col" style="max-width:320px">
                  <label>
                    <input type="checkbox" id="vrCapDiscount" style="margin-right:6px">
                    Limitar desconto ao valor do benef√≠cio
                  </label>
                  <div class="vr-help">
                    Quando marcado, o desconto (6% do sal√°rio por padr√£o) jamais supera o total do VR do m√™s para aquele colaborador.
                  </div>
                </div>
              </div>

              <div class="table-wrap">
                <table class="table" id="vrTable">
                  <thead>
                    <tr>
                      <th>Optou</th>
                      <th class="vr-cell-left">Funcion√°rio</th>
                      <th>Sal√°rio (R$)</th>
                      <th>Valor di√°rio (R$)</th>
                      <th>Dias √∫teis</th>
                      <th>Dia cr√©dito</th>
                      <th>Pr√≥ximo cr√©dito</th>
                      <th>Benef√≠cio</th>
                      <th>Desconto</th>
                      <th>L√≠quido</th>
                    </tr>
                  </thead>
                  <tbody id="vrBody"><tr><td colspan="10">‚Äî</td></tr></tbody>
                  <tfoot>
                    <tr>
                      <th colspan="2" class="t-right">Totais</th>
                      <th></th><th></th><th></th><th></th><th></th>
                      <th id="vrSumBeneficio">R$ 0,00</th>
                      <th id="vrSumDesconto">R$ 0,00</th>
                      <th id="vrSumLiquido">R$ 0,00</th>
                    </tr>
                  </tfoot>
                </table>
              </div>

              <div class="vr-help" style="margin-top:8px">
                Observa√ß√£o: os campos por funcion√°rio aceitam sobrescrever os padr√µes
                (valor di√°rio, dias, % desconto e dia do cr√©dito).
              </div>

            </div>
          </div>
    </section>
    -->

  </main>
  </div>

  <!-- =========================================================
      MODAL: BENEF√çCIOS (VT/VR)
      Estrutura igual ao modalFuncionario
  ========================================================= -->

    <div class="modal" id="modalBeneficios" role="dialog" aria-modal="true" aria-labelledby="benefModalTitle" style="display:none;">
      <div class="modal-content">

        <!-- Header do MODAL (padr√£o do seu sistema) -->
        <div class="modal-header">
          <span id="benefModalTitle">Benef√≠cios</span>

          <!-- Bot√£o X (padr√£o) -->
          <button type="button" class="btn btn-light" id="btnCloseBeneficios" aria-label="Fechar">
            <i class="fa-solid fa-xmark" aria-hidden="true"></i>
          </button>
        </div>

        <!-- Body do MODAL -->
        <div class="modal-body">

          <!-- ‚úÖ Escopo recomendado (pra casar com o CSS que te passei) -->
          <div class="beneficios-pro">

            <div class="max-w-7xl mx-auto">

              <!-- Header interno do m√≥dulo (seu layout) -->
              <header class="flex flex-col md:flex-row justify-between items-center mb-10 gap-6">
                <div>
                  <h1 class="text-3xl font-black tracking-tighter bg-clip-text text-transparent bg-gradient-to-r from-cyan-400 to-pink-500">
                    BENEF√çCIOS INTELLIGENCE
                  </h1>
                  <p class="text-slate-400 text-sm font-medium">Gest√£o de Folha & Rotinas Mensais</p>
                </div>

                <nav class="glass-card p-1 flex gap-2">
                  <button onclick="switchTab('VT')" id="btnTabVT" class="tab-btn active px-6 py-2 font-bold text-sm" type="button">
                    VALE TRANSPORTE
                  </button>
                  <button onclick="switchTab('VR')" id="btnTabVR" class="tab-btn px-6 py-2 font-bold text-sm" type="button">
                    VALE REFEI√á√ÉO
                  </button>
                </nav>
              </header>

              <!-- KPI Dashboard -->
              <div id="kpiContainer" class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
                <!-- Injetado via JS -->
              </div>

              <!-- =========================
                  PANE VT
              ========================== -->
              <section id="paneVT" class="tab-content">

                <!-- Painel de Configura√ß√£o VT -->
                <div class="glass-card p-6 mb-8">
                  <div class="grid grid-cols-1 md:grid-cols-4 gap-6 items-end">
                    <div>
                      <label class="block text-xs font-bold text-slate-500 mb-2">TARIFA PADR√ÉO (R$)</label>
                      <input type="number" step="0.01" id="globalVtTarifa" class="w-full p-3" value="5.50" onchange="calculateAll()">
                    </div>

                    <div>
                      <label class="block text-xs font-bold text-slate-500 mb-2">DIAS √öTEIS (CALEND√ÅRIO)</label>
                      <input type="number" id="globalVtDias" class="w-full p-3" value="22" onchange="calculateAll()">
                    </div>

                    <div>
                      <label class="block text-xs font-bold text-slate-500 mb-2">DIA CR√âDITO GERAL</label>
                      <input type="number" id="vtCreditDay" class="w-full p-3" value="1" placeholder="1 a 31">
                    </div>

                    <div class="flex flex-col gap-2">
                      <button class="btn-tech px-6 py-3 rounded-xl font-bold text-sm" onclick="exportData('VT')" type="button">
                        FECHAR FOLHA VT <i class="fa-solid fa-lock ml-2" aria-hidden="true"></i>
                      </button>
                    </div>
                  </div>

                  <div class="mt-4 flex flex-wrap gap-4 items-center justify-between">
                    <div class="text-[10px] text-slate-500 uppercase tracking-widest flex items-center gap-2">
                      <i class="fa-solid fa-circle-info text-cyan-400" aria-hidden="true"></i>
                      C√°lculo baseado na regra legal de 6% sobre o sal√°rio base.
                    </div>

                    <div class="flex gap-3">
                      <button class="text-[11px] font-bold text-slate-400 hover:text-white transition uppercase tracking-wider" id="btnExportVTCSV" type="button">
                        <i class="fa-regular fa-file-excel mr-1" aria-hidden="true"></i> Excel
                      </button meaning="button">

                      <button class="text-[11px] font-bold text-slate-400 hover:text-white transition uppercase tracking-wider" id="btnExportVTPDF" type="button">
                        <i class="fa-regular fa-file-pdf mr-1" aria-hidden="true"></i> PDF
                      </button>
                    </div>
                  </div>
                </div>

                <!-- Tabela de Colaboradores VT -->
                <div class="glass-card overflow-hidden">
                  <div class="p-6 bg-slate-800/30 flex justify-between items-center border-b border-white/5">
                    <h3 class="font-bold text-slate-200">Gest√£o de Ativos</h3>
                    <span class="text-[10px] bg-cyan-500/20 text-cyan-400 px-3 py-1 rounded-full font-bold">FEVEREIRO/2026</span>
                  </div>

                  <div class="overflow-x-auto p-4">
                    <table class="tech-table" id="vtTable">
                      <thead>
                        <tr>
                          <th>Ativo</th>
                          <th class="text-left">Funcion√°rio</th>
                          <th>Tarifa (R$)</th>
                          <th>Desc. 6%</th>
                          <th>Custo Empresa</th>
                          <th>Pr√≥x. Cr√©dito</th>
                          <th>Total (R$)</th>
                        </tr>
                      </thead>
                      <tbody id="vtTableBody">
                        <!-- Injetado via JS -->
                        <tr><td colspan="7" style="opacity:.7;">‚Äî</td></tr>
                      </tbody>
                    </table>
                  </div>
                </div>

              </section>

              <!-- =========================
                  PANE VR
              ========================== -->
              <section id="paneVR" class="tab-content hidden">

                <div class="glass-card p-6 mb-8">
                  <div class="grid grid-cols-1 md:grid-cols-4 gap-6 items-end">
                    <div>
                      <label class="block text-xs font-bold text-slate-500 mb-2">VALOR DI√ÅRIO VR (R$)</label>
                      <input type="number" id="globalVrDiario" class="w-full p-3" value="35.00" onchange="calculateAll()">
                    </div>

                    <div>
                      <label class="block text-xs font-bold text-slate-500 mb-2">DIAS √öTEIS</label>
                      <input type="number" id="globalVrDias" class="w-full p-3" value="22" onchange="calculateAll()">
                    </div>

                    <div>
                      <label class="flex items-center gap-2 cursor-pointer mb-2">
                        <input type="checkbox" id="limitVrDiscount" checked onchange="calculateAll()">
                        <span class="text-xs font-bold text-slate-500">LIMITAR DESCONTO AO VR</span>
                      </label>
                      <div class="text-[10px] text-slate-500">O desconto nunca supera o valor do benef√≠cio</div>
                    </div>

                    <button class="btn-tech px-8 py-3 rounded-xl font-bold text-sm" onclick="exportData('VR')" type="button">
                      FECHAR FOLHA VR <i class="fa-solid fa-lock ml-2" aria-hidden="true"></i>
                    </button>
                  </div>
                </div>

                <div class="glass-card overflow-hidden">
                  <div class="overflow-x-auto p-4">
                    <table class="tech-table">
                      <thead>
                        <tr>
                          <th>Optante</th>
                          <th class="text-left">Colaborador</th>
                          <th>Valor Mensal</th>
                          <th>Desconto Aplicado</th>
                          <th>L√≠quido Empresa</th>
                          <th>Status</th>
                        </tr>
                      </thead>
                      <tbody id="vrTableBody">
                        <!-- Injetado via JS -->
                        <tr><td colspan="6" style="opacity:.7;">‚Äî</td></tr>
                      </tbody>
                    </table>
                  </div>
                </div>

              </section>

            </div><!-- /.max-w-7xl -->
          </div><!-- /.beneficios-pro -->

        </div><!-- /.modal-body -->

        <!-- Footer do MODAL (padr√£o do seu sistema) -->
        <div class="modal-footer">
          <button class="btn btn-light" id="btnFecharBeneficios" type="button">Fechar</button>
        </div>

      </div><!-- /.modal-content -->
    </div><!-- /.modal -->

    <!-- =========================================================
        (Opcional) clique no backdrop fecha
        Voc√™ pode colocar isso no seu JS (n√£o √© obrigat√≥rio):
        modalBeneficios.addEventListener("click", e => {
          if(e.target === modalBeneficios) fecharModalBeneficios();
        });
    ========================================================= -->



  <!-- Modal: Batimentos do Dia -->
  <div class="modal" id="modalBatimentosDia" role="dialog" aria-modal="true" aria-labelledby="batimentosDiaTitulo">
    <div class="modal-content">
      <div class="modal-header">
        <span id="batimentosDiaTitulo">Batimentos do dia</span>
      </div>
      <div class="modal-body">
        <div class="bat-dia-nav">
          <button class="btn btn-light" id="btnPrevDia">‚óÄ Dia anterior</button>
          <div class="bat-dia-picker">
            <input type="date" id="batimentosDatePicker">
          </div>
          <button class="btn btn-light" id="btnNextDia">Pr√≥ximo dia ‚ñ∂</button>
        </div>
        <table class="table">
          <thead>
            <tr><th>#</th><th>Tipo</th><th>Hor√°rio</th><th>Origem</th><th>Observa√ß√£o</th></tr>
          </thead>
          <tbody id="batimentosDiaBody"><tr><td colspan="5">-</td></tr></tbody>
        </table>
      </div>
      <div class="modal-footer">
        <button class="btn btn-light" id="fecharBatimentosDia">Fechar</button>
        <button class="btn btn-ghost" id="justificarAusenciaDia">Justificar Aus√™ncia</button>
        <button class="btn btn-primary" id="incluirPontoDia">Incluir Ponto</button>
      </div>
    </div>
  </div>

  <!-- Modal Funcion√°rio -->
  <div class="modal" id="modalFuncionario" role="dialog" aria-modal="true" aria-labelledby="funcModalTitle">
    <div class="modal-content">
      <div class="modal-header">
        <span id="funcModalTitle">Funcion√°rio</span>
      </div>
        <div class="modal-body">
          <div class="emp-modal-header">

            <!-- ‚úÖ AVATAR CORRIGIDO (anel degrad√™ + recorte redondo) -->
            <div class="emp-avatar" id="funcModalAvatarWrap" aria-label="Foto do funcion√°rio">
              <div class="emp-avatar-inner">
                <img
                  id="funcModalAvatar"
                  src="assets/img/user.png"
                  alt="Foto do funcion√°rio"
                  loading="lazy"
                  decoding="async"
                  onerror="this.src='assets/img/user.png'"
                />
              </div>
            </div>
            <!-- ‚úÖ FIM AVATAR -->

            <div>
              <div class="emp-name" id="funcModalNome">‚Äî</div>
              <div class="emp-role" id="funcModalFuncao">‚Äî</div>
            </div>
          </div>

        <!-- Abas (Documentos, Documentos importantes, Cursos) -->
        <div class="emp-tabs" role="tablist" aria-label="Documentos do funcion√°rio">
          <button
            class="btn btn-light emp-tab-btn active"
            id="btnTabDocsSimples"
            data-target="#paneDocsSimples"
            type="button">
            <i class="fa-regular fa-folder-open" aria-hidden="true"></i> Documentos
          </button>

          <button
            class="btn btn-warn emp-tab-btn"
            id="btnTabDocsImportantes"
            type="button"
            data-target="#paneDocsImportantes"
            data-impdocs-open="1"
            data-emp-id="123">
            <i class="fa-solid fa-triangle-exclamation" aria-hidden="true"></i>
            Documentos importantes
          </button>


          <!-- NOVA ABA: CURSOS -->
          <button
            class="btn btn-light emp-tab-btn"
            id="btnTabCursos"
            data-target="#paneCursos"
            type="button">
            <i class="fa-solid fa-graduation-cap" aria-hidden="true"></i> Cursos
          </button>
        </div>

        <!-- Pane: Documentos (Explorador de arquivos) -->
        <div class="emp-pane active" id="paneDocsSimples">
          <div class="emp-file-explorer">
            <!-- Barra superior: caminho + a√ß√µes -->
            <div class="fe-toolbar">
              <div class="fe-path" id="fePath"></div>

              <div class="fe-actions">
                <button class="btn btn-light" type="button" id="feBtnNewFolder">
                  <i class="fa-regular fa-folder"></i> Nova pasta
                </button>
                <button class="btn btn-light" type="button" id="feBtnRename">
                  <i class="fa-regular fa-pen-to-square"></i> Renomear
                </button>
                <button class="btn btn-light" type="button" id="feBtnDelete">
                  <i class="fa-regular fa-trash-can"></i> Excluir
                </button>
                <button class="btn btn-light" type="button" id="feBtnCopy">
                  <i class="fa-regular fa-copy"></i> Copiar
                </button>
                <button class="btn btn-light" type="button" id="feBtnPaste">
                  <i class="fa-regular fa-clipboard"></i> Colar
                </button>
                <button id="feBtnDownload" class="btn btn-light" type="button">
                  <i class="fa-solid fa-download"></i> Baixar
                </button>

                <label class="btn btn-ok fe-upload-label">
                  <i class="fa-solid fa-upload" aria-hidden="true"></i> Importar arquivos
                  <input type="file" id="feUpload" multiple accept="*/*" style="display:none">
                </label>
              </div>
            </div>

            <!-- Corpo: √°rvore de pastas + lista de itens -->
            <div class="fe-body">
              <div class="fe-tree" id="feTree"></div>

              <div class="fe-list-wrap">
                <table class="table fe-list" id="feList">
                  <thead>
                    <tr>
                      <th>Nome</th>
                      <th>Tipo</th>
                      <th>Tamanho</th>
                      <th>Modificado em</th>
                    </tr>
                  </thead>
                  <tbody>
                    <!-- linhas geradas via JS -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

          <!-- Pane: Documentos importantes -->
        <div class="emp-pane" id="paneDocsImportantes" data-funcionario-id="">

          <!-- Card do formul√°rio -->
          <div class="imp-docs-form imp-left">

            <!-- Arquivo -->
            <div class="imp-field imp-file">
              <label for="impDocFile">Arquivo</label>
              <input type="file" id="impDocFile" accept=".pdf,.png,.jpg,.jpeg">
            </div>

            <!-- Nome -->
            <div class="imp-field imp-name">
              <label for="impDocName">Nome do documento</label>
              <input type="text" id="impDocName" placeholder="Ex.: CNH, ASO, Certid√£o">
            </div>

            <!-- Tipo + l√°pis -->
            <div class="imp-field imp-type">
              <label for="impDocType">Tipo</label>

              <div class="imp-type-grid">
                <select id="impDocType">
                  <option value="">Selecione...</option>
                  <!-- ‚úÖ depois voc√™ vai popular pelo back (tipos ativos) -->
                  <option value="CNH">CNH</option>
                  <option value="ASO">ASO</option>
                  <option value="Certid√£o">Certid√£o</option>
                  <option value="Outros">Outros</option>
                </select>

                <!-- √çcone l√°pis (abre modal CRUD de tipos) -->
                <button
                  type="button"
                  class="imp-type-edit"
                  id="btnOpenTipoDocModal"
                  aria-label="Cadastrar/editar tipos de documento"
                  title="Cadastrar/editar tipos">
                  <i class="fa-regular fa-pen-to-square" aria-hidden="true"></i>
                </button>
              </div>

              <small class="imp-help"></small>
            </div>

            <!-- Emiss√£o -->
            <div class="imp-field imp-issue">
              <label for="impDocIssue">Data de emiss√£o</label>
              <input type="date" id="impDocIssue">
            </div>

            <!-- Validade -->
            <div class="imp-field imp-due">
              <label for="impDocDue">Data de validade</label>
              <input type="date" id="impDocDue">
            </div>

            <!-- A√ß√µes -->
            <div class="imp-field imp-actions">
              <button class="btn btn-ok" id="btnAddImpDoc" type="button">
                <i class="fa-solid fa-plus" aria-hidden="true"></i> Adicionar
              </button>
            </div>

          </div><!-- /.imp-docs-form -->

          <!-- Alert/feedback -->
          <div class="imp-alert" id="impDocsAlert" style="display:none"></div>

          <!-- Tabela -->
          <table class="table" style="margin-top:8px">
            <thead>
              <tr>
                <th>Nome</th>
                <th>Tipo</th>
                <th>Emiss√£o</th>
                <th>Validade</th>
                <th>A√ß√µes</th>
              </tr>
            </thead>
            <tbody id="impDocsTable">
              <tr><td colspan="5">‚Äî</td></tr>
            </tbody>
          </table>

        </div><!-- /#paneDocsImportantes -->

        <!-- =========================================================
              MODAL: Tipos de Documento Importante (CRUD UI)
              Abre ao clicar no l√°pis
        ========================================================= -->
        <div class="modal" id="modalTipoDocumento" role="dialog" aria-modal="true" aria-labelledby="tipoDocModalTitle" style="display:none;">
            <div class="modal-content">

              <div class="modal-header">
                <span id="tipoDocModalTitle">Tipos de documento</span>

                <!-- bot√£o X (se voc√™ quiser) -->
                <button type="button" class="btn btn-light" id="btnFecharTipoDoc" aria-label="Fechar">
                  <i class="fa-solid fa-xmark" aria-hidden="true"></i>
                </button>
              </div>

              <div class="modal-body">
                <!-- Form: criar/editar -->
                <div class="tipo-doc-form">

                  <!-- Nome (novo nome ou renomear) -->
                  <div class="tipo-doc-field">
                    <label for="tipoDocNome">Nome do tipo</label>
                    <input type="text" id="tipoDocNome" placeholder="Ex.: Atestado, NR-10, Crach√°, etc.">
                    <small class="tipo-doc-help">
                      Para criar novo tipo de documento, basta inserir o nome e salvar.
                    </small>
                  </div>

                  <!-- Alert interno do modal -->
                  <div class="imp-alert" id="tipoDocAlert" style="display:none"></div>

                </div>

                <!-- Lista visual (opcional, mas ajuda o usu√°rio) -->
                <div style="margin-top:12px;">
                  <div class="filehint" style="margin-bottom:6px;">
                    <i class="fa-regular fa-rectangle-list" aria-hidden="true"></i>
                    Tipos cadastrados (ativos)
                  </div>

                  <table class="table" id="tipoDocTable">
                    <thead>
                      <tr>
                        <th>Nome</th>
                        <th>A√ß√µes</th>
                      </tr>
                    </thead>
                    <tbody id="tipoDocTableBody">
                      <tr><td colspan="4">‚Äî</td></tr>
                    </tbody>
                  </table>
                </div>
              </div>

              <div class="modal-footer">
                <button class="btn btn-light" type="button" id="btnCancelarTipoDoc">
                  Cancelar
                </button>

                <button class="btn btn-ok" type="button" id="btnSalvarTipoDoc">
                  <i class="fa-regular fa-floppy-disk" aria-hidden="true"></i> Salvar
                </button>
              </div>

            </div>
        </div>

        <!-- =========================================================
            PANE: CURSOS (CAT√ÅLOGO + V√çNCULO AO FUNCION√ÅRIO)
            Layout inspirado no exemplo (cat√°logo √† esquerda, v√≠nculo + lista √† direita)
            ‚úÖ Mant√©m TODOS os IDs para seu JS continuar funcionando
        ========================================================= -->
        <div class="emp-pane" id="paneCursos" aria-labelledby="tabCursosTitle">

          <input type="hidden" id="cursosEmpId" value="" />

          <header class="cursos-pane-head">
            <div class="cursos-pane-head__titles">
              <h3 id="tabCursosTitle" class="cursos-pane-title">Cursos & Certifica√ß√µes</h3>
              <p class="cursos-pane-subtitle">
                Cadastre cursos no cat√°logo e vincule ao funcion√°rio com validade (ou deixe em branco para Permanente).
              </p>
            </div>
          </header>

          <main class="cursos-layout">

            <!-- COLUNA ESQUERDA: CAT√ÅLOGO -->
            <section class="cursos-col cursos-col--left" aria-label="Cat√°logo de Cursos">
              <div class="cursos-section-head">
                <h4 class="cursos-section-title">
                  <i class="fa-solid fa-book-bookmark" aria-hidden="true"></i>
                  Cat√°logo de Cursos
                </h4>

                <button class="btn btn-ok" id="btnNovoCurso" type="button">
                  <i class="fa-solid fa-plus" aria-hidden="true"></i>
                  <span>Novo curso</span>
                </button>
              </div>

              <div class="glass-card cursos-card">
                <div class="cursos-card-toolbar">
                  <div class="cursos-search">
                    <i class="fa-solid fa-magnifying-glass" aria-hidden="true"></i>
                    <input
                      id="cursoSearch"
                      type="text"
                      placeholder="Buscar no cat√°logo (nome, NR, carga, categoria...)"
                      autocomplete="off"
                    />
                  </div>

                  <button class="btn" id="btnRefreshCursos" type="button" title="Recarregar cat√°logo" aria-label="Recarregar cat√°logo">
                    <i class="fa-solid fa-rotate" aria-hidden="true"></i>
                  </button>
                </div>

                <div class="cursos-table-wrap cursos-scroll">
                  <table class="tech-table cursos-table" id="tblCursosCatalogo" aria-label="Tabela do cat√°logo de cursos">
                    <thead>
                      <tr>
                        <th class="col-curso">Curso</th>
                        <th class="col-carga" style="text-align:center;">Carga</th>
                        <th class="col-acoes" style="text-align:right;">A√ß√µes</th>
                      </tr>
                    </thead>

                    <!--
                      JS deve renderizar assim na col "Curso":
                      <div class="curso-title">NR-10 B√°sico</div>
                      <div class="curso-sub">Seguran√ßa</div>
                      (opcional) <div class="curso-sub2">Observa√ß√£o...</div>
                    -->
                    <tbody id="cursosCatalogoBody"></tbody>
                  </table>

                  <div class="cursos-empty filehint" id="cursosCatalogoEmpty" style="display:none;">
                    Nenhum curso no cat√°logo. Clique em <b>Novo curso</b>.
                  </div>
                </div>
              </div>
            </section>

            <!-- COLUNA DIREITA: VINCULAR + CERTIFICA√á√ïES -->
            <section class="cursos-col cursos-col--right" aria-label="Cursos do Funcion√°rio">

              <!-- Card: Vincular -->
              <div class="glass-card cursos-card">
                <div class="cursos-section-head cursos-section-head--inside">
                  <h4 class="cursos-section-title">
                    <i class="fa-solid fa-link" aria-hidden="true"></i>
                    Vincular Curso ao Funcion√°rio
                  </h4>

                  <button class="btn" id="btnReloadCursosFuncionario" type="button" title="Recarregar v√≠nculo do funcion√°rio" aria-label="Recarregar v√≠nculo do funcion√°rio">
                    <i class="fa-solid fa-rotate" aria-hidden="true"></i>
                  </button>
                </div>

                <div class="cursos-form-grid">
                  <div class="cursos-field cursos-field--full">
                    <label for="cursoSelect">Selecionar do cat√°logo</label>
                    <select id="cursoSelect">
                      <option value="">‚Äî Selecione um curso ‚Äî</option>
                    </select>
                  </div>

                  <div class="cursos-field">
                    <label for="cursoConclusao">Data de conclus√£o</label>
                    <input id="cursoConclusao" type="date" />
                  </div>

                  <div class="cursos-field">
                    <label for="cursoValidade">Validade (opcional)</label>
                    <input id="cursoValidade" type="date" />
                    <div class="filehint cursos-hint">* Deixe em branco para <b>Permanente</b></div>
                  </div>

                  <div class="cursos-field cursos-field--full">
                    <button class="btn btn-ok cursos-btn-primary" id="btnVincularCurso" type="button">
                      <i class="fa-regular fa-circle-check" aria-hidden="true"></i>
                      <span>Confirmar v√≠nculo</span>
                    </button>
                  </div>
                </div>
              </div>

              <!-- Card: Certifica√ß√µes -->
              <div class="glass-card cursos-card">
                <div class="cursos-section-head cursos-section-head--inside">
                  <h4 class="cursos-section-title">
                    <i class="fa-solid fa-award" aria-hidden="true"></i>
                    Certifica√ß√µes Conclu√≠das
                  </h4>
                </div>

                <div class="cursos-table-wrap">
                  <table class="tech-table cursos-table" id="tblCursosFuncionario" aria-label="Tabela de cursos do funcion√°rio">
                    <thead>
                      <tr>
                        <th class="col-curso">Curso</th>
                        <th class="col-conc">Conclus√£o</th>
                        <th class="col-status">Status / Validade</th>
                        <th class="col-acoes" style="text-align:right;">A√ß√µes</th>
                      </tr>
                    </thead>

                    <!--
                      JS deve renderizar a√ß√µes por linha (exemplo):
                      - Alterar validade/conclus√£o -> data-action="edit-vinculo"
                      - Alterar nome do curso -> data-action="edit-curso"
                      - Remover do funcion√°rio -> data-action="delete-vinculo"
                    -->
                    <tbody id="cursosFuncionarioBody"></tbody>
                  </table>

                  <div class="cursos-empty filehint" id="cursosFuncionarioEmpty" style="display:none;">
                    Nenhum curso vinculado a este funcion√°rio ainda.
                  </div>
                </div>
              </div>

            </section>
          </main>

          <!-- MODAL: CADASTRAR/EDITAR CURSO -->
          <div class="modal-overlay" id="modalCurso" style="display:none;" aria-hidden="true">
            <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="modalCursoTitle">
              <div class="modal-header">
                <div id="modalCursoTitle" class="modal-title">Curso</div>
                <button id="btnCloseModalCurso" class="btn" type="button" aria-label="Fechar">
                  <i class="fa-solid fa-xmark" aria-hidden="true"></i>
                </button>
              </div>

              <div class="modal-body">
                <input type="hidden" id="cursoId" value="" />

                <div class="cursos-modal-grid">
                  <div class="cursos-field cursos-field--full">
                    <label for="cursoNome">Nome do curso *</label>
                    <input id="cursoNome" type="text" placeholder="Ex.: NR-35 Trabalho em Altura" />
                  </div>

                  <div class="cursos-field">
                    <label for="cursoCarga">Carga hor√°ria (h)</label>
                    <input id="cursoCarga" type="number" min="0" step="1" placeholder="Ex.: 8" />
                  </div>

                  <!-- ‚úÖ NOVO: Categoria fixa -->
                  <div class="cursos-field">
                    <label for="cursoCategoria">Categoria *</label>
                    <select id="cursoCategoria">
                      <option value="">‚Äî Selecione ‚Äî</option>
                      <option value="SOFT_SKILL">Soft Skill</option>
                      <option value="SEGURANCA">Seguran√ßa</option>
                      <option value="TECNICO">T√©cnico</option>
                      <option value="GESTAO">Gest√£o</option>
                    </select>
                  </div>

                  <!-- Opcional (mantive seu id, se quiser usar) -->
                  <div class="cursos-field cursos-field--full">
                    <label for="cursoObs">Observa√ß√£o (opcional)</label>
                    <input id="cursoObs" type="text" placeholder="Ex.: NR / Obrigat√≥rio / Reciclagem..." />
                  </div>

                  <div class="cursos-field cursos-field--full">
                    <label for="cursoDescricao">Descri√ß√£o (opcional)</label>
                    <textarea id="cursoDescricao" rows="3" placeholder="Detalhes do curso..."></textarea>
                  </div>
                </div>

                <div class="filehint" style="margin-top:10px;">
                  Dica: a <b>validade</b> √© definida no v√≠nculo com o funcion√°rio (pode ser permanente).
                </div>
              </div>

              <div class="modal-footer">
                <button class="btn" id="btnCancelarCurso" type="button">Cancelar</button>
                <button class="btn btn-ok" id="btnSalvarCurso" type="button">
                  <i class="fa-regular fa-floppy-disk" aria-hidden="true"></i>
                  <span>Salvar curso</span>
                </button>
              </div>
            </div>
          </div>

          <!-- MODAL: EDITAR V√çNCULO (VALIDADE/CONCLUS√ÉO) -->
          <div class="modal-overlay" id="modalEmpCurso" style="display:none;" aria-hidden="true">
            <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="modalEmpCursoTitle">
              <div class="modal-header">
                <div id="modalEmpCursoTitle" class="modal-title">Editar curso do funcion√°rio</div>
                <button id="btnCloseModalEmpCurso" class="btn" type="button" aria-label="Fechar">
                  <i class="fa-solid fa-xmark" aria-hidden="true"></i>
                </button>
              </div>

              <div class="modal-body">
                <input type="hidden" id="empCursoId" value="" />

                <div class="cursos-modal-grid">
                  <div class="cursos-field cursos-field--full">
                    <label>Curso</label>
                    <div id="empCursoNomePreview" class="glass-card cursos-preview">‚Äî</div>
                  </div>

                  <div class="cursos-field">
                    <label for="empCursoConclusao">Data de conclus√£o</label>
                    <input id="empCursoConclusao" type="date" />
                  </div>

                  <div class="cursos-field">
                    <label for="empCursoValidade">Validade (opcional)</label>
                    <input id="empCursoValidade" type="date" />
                    <div class="filehint cursos-hint">* Deixe em branco para <b>Permanente</b></div>
                  </div>
                </div>
              </div>

              <div class="modal-footer">
                <button class="btn" id="btnCancelarEmpCurso" type="button">Cancelar</button>
                <button class="btn btn-ok" id="btnSalvarEmpCurso" type="button">
                  <i class="fa-regular fa-floppy-disk" aria-hidden="true"></i>
                  <span>Salvar altera√ß√µes</span>
                </button>
              </div>
            </div>
          </div>

        </div>
        
      </div>

      <div class="modal-footer">
        <button class="btn btn-light" id="fecharFuncionario">Fechar</button>
      </div>
    </div>
  </div>


  <!-- Modal Criar Tipo de Documento -->
  <div class="modal" id="modalNovoDoc" role="dialog" aria-modal="true" aria-labelledby="novoDocTitulo">
    <div class="modal-content">
      <div class="modal-header" id="novoDocTitulo">Criar tipo de documento</div>
      <div class="modal-body">
        <div class="row">
          <div class="col">
            <label for="tplNome">Nome do tipo</label>
            <input type="text" id="tplNome" placeholder="Ex.: Atestado, Termo de Responsabilidade">
          </div>
        </div>
        <div class="row">
          <div class="col">
            <label for="tplTexto">Conte√∫do do modelo</label>
            <textarea id="tplTexto" spellcheck="false" placeholder="Digite o conte√∫do do documento. Voc√™ pode usar {{nome}}, {{documento}} e {{data}} para preencher automaticamente."></textarea>
          </div>
        </div>
        <div class="filehint">
          Dica: use <b>{{nome}}</b>, <b>{{documento}}</b> e <b>{{data}}</b> como vari√°veis que ser√£o preenchidas.
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-light" id="btnCancelarNovoDoc">Cancelar</button>
        <button class="btn btn-primary" id="btnSalvarNovoDoc">
          <i class="fa-regular fa-floppy-disk" aria-hidden="true"></i> Salvar tipo
        </button>
      </div>
    </div>
  </div>

  <!-- Modal Cadastro de Funcion√°rio -->
  <div class="modal" id="modalCadastroUsuario" role="dialog" aria-modal="true" aria-labelledby="cadastroTitulo">
    <div class="modal-content">
      <div class="modal-header" id="cadastroTitulo">Cadastro de Funcion√°rio</div>
      <div class="modal-body" id="modalCadastroBody"><!-- o bloco .gestao-cadastro ser√° movido aqui via JS --></div>
      <div class="modal-footer">
        <button class="btn btn-light" id="btnFecharCadastro">Fechar</button>
      </div>
    </div>
  </div>

  <!-- =========================
      HEADER: SINO + BOLINHA (ALERTA)
      - alerts.js usa: #btnAlerts e #notifDot
      ========================= -->
  <button class="icon-btn" id="btnAlerts" type="button" title="Lembretes" aria-label="Abrir Central de Lembretes">
    <i class="fa-regular fa-bell" aria-hidden="true"></i>

    <!-- JS controla display -->
    <span class="notif-dot" id="notifDot" aria-hidden="true" style="display:none;"></span>
  </button>


<!-- =========================
      MODAL LEMBRETES (CENTRAL)
      - alerts.js usa:
        #modalLembretes, #btnCloseLembretes, #btnFecharLembretesBottom,
        #btnNovoLembrete (opcional), #listaLembretesBody
      ========================= -->
  <div id="modalLembretes" class="modal-overlay" aria-hidden="true">
    <div class="modal-content-premium" role="dialog" aria-modal="true" aria-labelledby="tituloLembretes">

      <div class="modal-header-premium">
        <h2 id="tituloLembretes">
          <i class="fa-regular fa-bell" aria-hidden="true"></i>
          Central de Lembretes
        </h2>

        <button class="btn-close-modal" id="btnCloseLembretes" type="button" aria-label="Fechar">
          <i class="fa-solid fa-xmark" aria-hidden="true"></i>
        </button>
      </div>

      <div class="modal-body-premium">
        <div class="rem-table-wrapper">
          <table class="rem-table">
            <thead>
              <tr>
                <th>Funcion√°rio</th>
                <th>Emiss√£o</th>
                <th>Validade</th>
                <th class="text-center">Ativo</th>
                <th class="text-center">Corrigido</th>
              </tr>
            </thead>

            <tbody id="listaLembretesBody">
              <!-- O alerts.js vai substituir esse conte√∫do ao carregar do GET -->
              <tr>
                <td colspan="5" style="opacity:.7; padding:12px;">
                  Carregando lembretes...
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="modal-actions-premium">
        <button class="btn-snooze" id="btnFecharLembretesBottom" type="button">
          Fechar
        </button>

        <!-- Opcional: se voc√™ usa o modal de cadastro -->
        <button class="btn-resolve" id="btnNovoLembrete" type="button">
          <i class="fa-solid fa-plus" aria-hidden="true"></i>
          Novo Lembrete
        </button>
      </div>

    </div>
  </div>


  <!-- =========================
      POPUP ALARME (vence HOJE)
      - alerts.js usa:
        #popupAlarme, #alarmList, #btnSnooze, #btnResolve
      ========================= -->
  <div id="popupAlarme" class="alarm-overlay" aria-hidden="true">
    <div class="alarm-card" role="dialog" aria-modal="true" aria-labelledby="alarmTitle">
      <div class="alarm-icon-wrapper" aria-hidden="true">
        <i class="fa-solid fa-bell alarm-bell" aria-hidden="true"></i>
      </div>

      <h3 id="alarmTitle">Aten√ß√£o Necess√°ria!</h3>
      <p>Identificamos documentos vencendo hoje que requerem sua a√ß√£o imediata.</p>

      <div class="alarm-list" id="alarmList">
        <!-- Itens gerados via JS -->
      </div>

      <div class="alarm-actions">
        <button class="btn-snooze" id="btnSnooze" type="button">Lembrar em 1h</button>
        <button class="btn-resolve" id="btnResolve" type="button">Resolver agora</button>
      </div>
    </div>
  </div>


  <!-- ============================================
      (OPCIONAL) MODAL CADASTRO
      - alerts.js procura por:
        #modalCadastroUsuario, #btnFecharCadastro, #btnCancelarCadastro, #btnSalvarCadastro
      - Se voc√™ N√ÉO usa, pode apagar esse bloco inteiro.
      ============================================ -->
  <div id="modalCadastroUsuario" class="modal-overlay" aria-hidden="true" style="display:none;">
    <div class="modal-content-premium" role="dialog" aria-modal="true" aria-labelledby="tituloCadastro">

      <div class="modal-header-premium">
        <h2 id="tituloCadastro">
          <i class="fa-solid fa-plus" aria-hidden="true"></i>
          Novo Lembrete
        </h2>

        <button class="btn-close-modal" id="btnFecharCadastro" type="button" aria-label="Fechar">
          <i class="fa-solid fa-xmark" aria-hidden="true"></i>
        </button>
      </div>

      <div class="modal-body-premium">
        <p style="opacity:.7;">(Opcional) Conte√∫do do cadastro.</p>
        <!-- Seu formul√°rio aqui -->
      </div>

      <div class="modal-actions-premium">
        <button class="btn-snooze" id="btnCancelarCadastro" type="button">Cancelar</button>
        <button class="btn-resolve" id="btnSalvarCadastro" type="button">Salvar</button>
      </div>

    </div>
  </div>


  <!-- Tela p√∫blica de assinatura -->
  <div id="publicSign" class="public-sign" aria-live="polite">
    <div class="wrap">
      <div class="card">
        <div class="card-header">Assinar Documento</div>
        <div class="card-body">
          <div class="row">
            <div class="col">
              <label>Documento</label>
              <div id="pubDocTitle" class="kv-strong">‚Äî</div>
            </div>
            <div class="col">
              <label>Colaborador</label>
              <div id="pubDocWho" class="kv-strong">‚Äî</div>
            </div>
          </div>
          <div class="row" style="margin-top:8px">
            <div class="col">
              <label>Conte√∫do</label>
              <div id="pubDocText" class="doc-box scroll-styled" style="max-height:40vh"></div>
            </div>
          </div>
          <div class="row" style="margin-top:10px">
            <div class="col">
              <label>Assinatura</label>
              <div class="sig-toolbar" style="margin-bottom:6px">
                <button class="btn btn-light" id="btnLimparAssPublic">Limpar</button>
                <button class="btn btn-primary" id="btnBaixarPDFPublic">
                  <i class="fa-regular fa-file-pdf" aria-hidden="true"></i> Assinar e baixar PDF
                </button>
              </div>
              <div class="sig-wrap">
                <canvas id="sigPadPublic"></canvas>
              </div>
            </div>
          </div>
          <div class="inline-row mt-8">
            <button class="btn btn-light" id="btnFecharPublic">
              <i class="fa-solid fa-xmark" aria-hidden="true"></i> Fechar
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal do crach√° -->
  <div id="modalCracha" class="modal" style="display:none">
    <div class="modal-content cracha-modal">

      <!-- HEADER GRADIENTE -->
      <div class="cracha-header">
        <div class="cracha-header-title">
           Crach√° RCR Engenharia  
          <span class="cracha-header-sub">¬© Atrium ‚Ä¢ <span class="grad">2025</span></span>
        </div>
        <button
          type="button"
          id="btnFecharCracha"
          class="cracha-close"
          aria-label="Fechar crach√°"
        >
          <i class="fa-solid fa-xmark"></i>
        </button>
      </div>

      <!-- CART√ÉO DO CRACH√Å -->
      <div class="cracha-card">
        <div class="cracha-left">
          <div class="cracha-foto-wrap">
            <img id="crachaFoto" src="" alt="Foto do funcion√°rio">
          </div>
          <div class="cracha-nome" id="crachaNome">Nome do Funcion√°rio</div>
          <div class="cracha-cpf" id="crachaCpf">000.000.000-00</div>
        </div>

        <div class="cracha-right">
          <div class="cracha-field">
            <span class="label">Fun√ß√£o</span>
            <span class="value" id="crachaFuncao">‚Äî</span>
          </div>

          <div class="cracha-field">
            <span class="label">Cursos</span>
            <span class="value" id="crachaCursos">‚Äî</span>
          </div>

          <div class="cracha-field">
            <span class="label">Tipo de contrato</span>
            <span class="value" id="crachaContrato">‚Äî</span>
          </div>

          <div class="cracha-footer">
            <div class="cracha-empresa-sec">RCR Engenharia</div>
            <button class="btn btn-primary" id="btnCrachaGerar">
              <i class="fa-regular fa-id-card"></i>
              Gerar carteirinha
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  
  <!-- =========================================================
       Fallback UI (tabs + modais) ‚Äî n√£o depende do home.js
       Ajuda quando algum JS n√£o carrega / d√° erro.
  ========================================================= -->
  <script>
  (function(){
    function on(el, ev, fn){
      if(!el || el.dataset.bound === "1") return;
      el.addEventListener(ev, fn);
      el.dataset.bound = "1";
    }
    function show(el){
      if(!el) return;
      el.style.display = "flex";
      el.removeAttribute("hidden");
      el.setAttribute("aria-hidden","false");
      document.documentElement.classList.add("modal-open");
      document.body.classList.add("modal-open");
    }
    function hide(el){
      if(!el) return;
      el.style.display = "none";
      el.setAttribute("aria-hidden","true");
      document.documentElement.classList.remove("modal-open");
      document.body.classList.remove("modal-open");
    }
    function activateTab(tabId){
      if(!tabId) return;
      document.querySelectorAll("main .tab").forEach(sec => {
        sec.classList.toggle("active", sec.id === tabId);
      });
      document.querySelectorAll("#menu [data-tab]").forEach(li => {
        li.classList.toggle("active", li.getAttribute("data-tab") === tabId);
      });
    }

    document.addEventListener("DOMContentLoaded", function(){
      // Splash: garante que some mesmo se o home.js n√£o rodar
      var splash = document.getElementById("splash");
      if(splash){
        setTimeout(function(){ splash.style.display="none"; }, 450);
      }

      // Menu lateral (tabs principais)
      document.querySelectorAll("#menu [data-tab]").forEach(function(li){
        on(li, "click", function(){
          var id = li.getAttribute("data-tab");
          activateTab(id);
          // fecha sidebar no mobile (se existir classe/open)
          var sidebar = document.getElementById("sidebar");
          if(sidebar) sidebar.classList.remove("open");
          document.body.classList.remove("sidebar-open");
        });
      });

      // Submenus
      document.querySelectorAll(".has-submenu > .row-head").forEach(function(head){
        on(head, "click", function(){
          var li = head.closest(".has-submenu");
          if(!li) return;
          var expanded = li.getAttribute("aria-expanded") === "true";
          li.setAttribute("aria-expanded", expanded ? "false" : "true");
          li.classList.toggle("open", !expanded);
        });
      });

      // Bot√£o hamburguer / fechar sidebar
      on(document.getElementById("btnHamb"), "click", function(){
        var sidebar = document.getElementById("sidebar");
        if(sidebar) sidebar.classList.toggle("open");
        document.body.classList.toggle("sidebar-open");
      });
      on(document.getElementById("btnCloseSidebar"), "click", function(){
        var sidebar = document.getElementById("sidebar");
        if(sidebar) sidebar.classList.remove("open");
        document.body.classList.remove("sidebar-open");
      });

      // Sub-tabs de Documentos (Gerar / Clicksign)
      document.querySelectorAll(".docs-tab-btn[data-target]").forEach(function(btn){
        on(btn, "click", function(){
          var target = btn.getAttribute("data-target");
          document.querySelectorAll(".docs-tab-btn").forEach(b => b.classList.remove("active"));
          btn.classList.add("active");

          document.querySelectorAll("#tabDocs .docs-pane").forEach(p => p.classList.remove("active"));
          var pane = document.querySelector(target);
          if(pane) pane.classList.add("active");
        });
      });

      // Tabs dentro do modal do funcion√°rio (Documentos / Importantes / Cursos)
      document.querySelectorAll(".emp-tab-btn[data-target], button[data-impdocs-open][data-target]").forEach(function(btn){
        on(btn, "click", function(){
          var target = btn.getAttribute("data-target");
          var tabsWrap = btn.closest(".emp-tabs");
          if(tabsWrap){
            tabsWrap.querySelectorAll(".emp-tab-btn, .btn-warn").forEach(b => b.classList.remove("active"));
            btn.classList.add("active");
          }
          var modalBody = btn.closest(".modal-body");
          if(modalBody){
            modalBody.querySelectorAll(".emp-pane").forEach(p => p.classList.remove("active"));
          }
          var pane = document.querySelector(target);
          if(pane) pane.classList.add("active");
        });
      });

      // Modais principais: abrir/fechar (fallback)
      var wizard = document.getElementById("wizard");
      on(document.getElementById("btn-open"), "click", function(){ show(wizard); });
      on(document.getElementById("btn-close"), "click", function(){ hide(wizard); });
      if(wizard){
        on(wizard, "click", function(e){
          if(e.target === wizard) hide(wizard);
        });
      }

      var tplModal = document.getElementById("tplModal");
      on(document.getElementById("btn-templates"), "click", function(){ show(tplModal); });
      on(document.getElementById("btn-close-tpl"), "click", function(){ hide(tplModal); });
      if(tplModal){
        on(tplModal, "click", function(e){
          if(e.target === tplModal) hide(tplModal);
        });
      }

      // Modal tipos de documento
      var tipoModal = document.getElementById("modalTipoDocumento");
      on(document.getElementById("btnOpenTipoDocModal"), "click", function(){ show(tipoModal); });
      on(document.getElementById("btnFecharTipoDoc"), "click", function(){ hide(tipoModal); });
      on(document.getElementById("btnCancelarTipoDoc"), "click", function(){ hide(tipoModal); });

      // Lembretes
      //var lembretes = document.getElementById("modalLembretes");
      //on(document.getElementById("btnAlerts"), "click", function(){ show(lembretes); });
      //on(document.getElementById("btnCloseLembretes"), "click", function(){ hide(lembretes); });
      //on(document.getElementById("btnFecharLembretesBottom"), "click", function(){ hide(lembretes); });

      // Crach√°
      var cracha = document.getElementById("modalCracha");
      on(document.getElementById("btnFecharCracha"), "click", function(){ hide(cracha); });

      // Ajustar/Justificar ponto (bot√µes no tabIncluir)
      var mAjuste = document.getElementById("modalAjustarPonto");
      on(document.getElementById("btnAjustarPonto"), "click", function(){ show(mAjuste); });
      on(document.getElementById("btnFecharAjustarPonto"), "click", function(){ hide(mAjuste); });
      on(document.getElementById("btnCancelarAjustePonto"), "click", function(){ hide(mAjuste); });

      var mJus = document.getElementById("modalJustificarAusencia");
      on(document.getElementById("btnJustificarAusencia"), "click", function(){ show(mJus); });
      on(document.getElementById("btnFecharJustificarAusencia"), "click", function(){ hide(mJus); });
      on(document.getElementById("btnCancelarJustificativa"), "click", function(){ hide(mJus); });
    });
  })();
  </script>


  <!-- =========================================================
       Loader de scripts com fallback de caminhos (evita "tela morta")
  ========================================================= -->
  <script>
  (function(){
    function loadScript(src){
      return new Promise(function(resolve,reject){
        var s = document.createElement("script");
        s.src = src;
        s.defer = true;
        s.onload = function(){ resolve(src); };
        s.onerror = function(){ reject(new Error("Falha ao carregar: " + src)); };
        document.body.appendChild(s);
      });
    }

    // Grupos: tenta o primeiro; se 404, tenta o pr√≥ximo (mant√©m ordem)
    var groups = [
      ["assets/js/core.js"],
      ["assets/js/ponto.js"],

      // Funcion√°rios (estrutura antiga / nova)
      ["assets/js/funcionarios/cracha-acesso.js"],
      ["assets/js/funcionarios/funcionarios-assinatura.js"],
      ["assets/js/funcionarios/funcionarios-explorer.js"],
      ["assets/js/funcionarios/funcionarios.js"],
      ["assets/js/funcionarios/funcionarios-cursos.js"],

      // Benef√≠cios
      ["assets/js/beneficios.js"],

      // Docs / assinatura
      ["assets/js/doc.assinatura.js"],
      ["assets/js/assinatura-publica.js"],
      ["assets/js/assinatura-clicksign.js"],

      // Outros
      ["assets/js/ponto-justificativa.js"],
      ["assets/js/usuarios.js"],
      ["assets/js/perfil-user.js"],
      ["assets/js/user-menu.js"],
      ["assets/js/alerts.js", "assets/js/alert.js"],
      ["assets/js/config-theme.js"],

      // Home por √∫ltimo
      ["assets/js/home.js"]
    ];

    (async function(){
      for (var i=0;i<groups.length;i++){
        var opts = groups[i];
        var ok = false;
        for (var j=0;j<opts.length;j++){
          try{
            await loadScript(opts[j]);
            ok = true;
            break;
          }catch(e){ /* tenta pr√≥ximo */ }
        }
        if(!ok){
          console.warn("[Atrium] N√£o consegui carregar nenhum destes scripts:", opts);
        }
      }
    })();
  })();
  </script>

<!-- Pr√©-carregar logo para o PDF -->
<img id="pdfLogoPreload" src="assets/img/logo_rcr_transparente.png" alt="" style="display:none"/>

</body>
</html>
